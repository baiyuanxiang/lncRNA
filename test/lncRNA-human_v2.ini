[fastqc-fq]
#the format of rawdata like "***_1.fq.gz", the output dir like "***_1.fq_fastqc/"
#if sample.path=2,fastqc run 2 times
fastqc=$tools.fastqc
fastqc.run=1
fastqc.param=--extract -o $dir.fastqc/$sample.name [% IF sample.library_type == "se" %] $sample.path.0 [% ELSE %] $sample.path.0 $sample.path.1 [% END %]
fastqc.beforescript=if [ ! -d $dir.fastqc/$sample.name ];then  mkdir $dir.fastqc/$sample.name;fi
fastqc.afterscript=if [ ! -d $dir.report/1_QualityControl ];then mkdir $dir.report/1_QualityControl;fi <br/>\
	cp $dir.fastqc/$sample.name/*_1.fq_fastqc/Images/per_base_sequence_content.png $dir.report/1_QualityControl/${sample.name}_1.per_base_sequence_content.png <br/>\
	cp $dir.fastqc/$sample.name/*_2.fq_fastqc/Images/per_base_sequence_content.png $dir.report/1_QualityControl/${sample.name}_2.per_base_sequence_content.png <br/>\
	cp $dir.fastqc/$sample.name/*_1.fq_fastqc/Images/per_base_quality.png $dir.report/1_QualityControl/${sample.name}_1.per_base_quality.png <br/>\
	cp $dir.fastqc/$sample.name/*_2.fq_fastqc/Images/per_base_quality.png $dir.report/1_QualityControl/${sample.name}_2.per_base_quality.png <br/>\
	cp $dir.fastqc/$sample.name/*_1.fq_fastqc/Images/per_sequence_gc_content.png $dir.report/1_QualityControl/${sample.name}_1.per_sequence_gc_content.png <br/>\
	cp $dir.fastqc/$sample.name/*_2.fq_fastqc/Images/per_sequence_gc_content.png $dir.report/1_QualityControl/${sample.name}_2.per_sequence_gc_content.png <br/>\
	cp $config.readme/qc.readme.txt $dir.report/1_QualityControl/readme.txt
fastqc.checkbefore=[% FOREACH path IN sample.path %] $path| [% END %]
fastqc.checkafter=no

[fastqc-fastq]
#the format of rawdata like "***_R1.fastq.gz", the output dir like "***_R1_fastqc/"
#if sample.path=2,fastqc run 2 times
fastqc=$tools.fastqc
fastqc.run=1
fastqc.param=--extract -o $dir.fastqc/$sample.name [% IF sample.library_type == "se" %] $sample.path.0 [% ELSE %] $sample.path.0 $sample.path.1 [% END %]
fastqc.beforescript=if [ ! -d $dir.fastqc/$sample.name ];then  mkdir $dir.fastqc/$sample.name;fi
fastqc.afterscript=if [ ! -d $dir.report/1_QualityControl ];then mkdir $dir.report/1_QualityControl;fi <br/>\
	cp $dir.fastqc/$sample.name/*_R1*_fastqc/Images/per_base_sequence_content.png $dir.report/1_QualityControl/${sample.name}_1.per_base_sequence_content.png <br/>\
	cp $dir.fastqc/$sample.name/*_R2*_fastqc/Images/per_base_sequence_content.png $dir.report/1_QualityControl/${sample.name}_2.per_base_sequence_content.png <br/>\
	cp $dir.fastqc/$sample.name/*_R1*_fastqc/Images/per_base_quality.png $dir.report/1_QualityControl/${sample.name}_1.per_base_quality.png <br/>\
	cp $dir.fastqc/$sample.name/*_R2*_fastqc/Images/per_base_quality.png $dir.report/1_QualityControl/${sample.name}_2.per_base_quality.png <br/>\
	cp $dir.fastqc/$sample.name/*_R1*_fastqc/Images/per_sequence_gc_content.png $dir.report/1_QualityControl/${sample.name}_1.per_sequence_gc_content.png <br/>\
	cp $dir.fastqc/$sample.name/*_R2*_fastqc/Images/per_sequence_gc_content.png $dir.report/1_QualityControl/${sample.name}_2.per_sequence_gc_content.png <br/>\
	cp $config.readme/qc.readme.txt $dir.report/1_QualityControl/readme.txt
fastqc.checkbefore=[% FOREACH path IN sample.path %] $path| [% END %]
fastqc.checkafter=no

[filter]
#remove rRNA
bowtie2=$tools.bowtie2
bowtie2.run=1
bowtie2.param=$parameter.bowtie2 -x $config.rRNA -1 $sample.path.0 -2 $sample.path.1 -S $dir.rRNA/${sample.name}.sam <br/>\
	$tools.samtools view -bS $dir.rRNA/${sample.name}.sam >$dir.rRNA/${sample.name}.bam <br/>\
	$tools.samtools flagstat $dir.rRNA/${sample.name}.bam >$dir.rRNA/${sample.name}.bam.rRNA.stat <br/>\
	perl $tools.bin/extract.unmap_rRNA.fq.pl $dir.rRNA/${sample.name}.bam $sample.path.0 $sample.path.1 $dir.rRNA/${sample.name}_1.fq $dir.rRNA/${sample.name}_2.fq 
bowtie2.afterscript=
bowtie2.checkbefore=[% FOREACH path IN sample.path %] $path| [% END %]
bowtie2.checkafter=$dir.rRNA/${sample.name}_1.fq.gz | $dir.rRNA/${sample.name}_2.fq.gz

#remove low quality reads
#fastq_quantity=1
SOAPnuke=$tools.SOAPnuke
SOAPnuke.param=[% IF sample.library_type == "se" %] filter -1 $dir.rRNA/${sample.name}_1.fq.gz $parameter.filter -o $dir.filter/$sample.name -C ${sample.name}.clean.fastq.gz \
        [% ELSE %] filter -1 $dir.rRNA/${sample.name}_1.fq.gz -2 $dir.rRNA/${sample.name}_2.fq.gz $parameter.filter -o $dir.filter/$sample.name -C ${sample.name}_1.clean.fq.gz -D ${sample.name}_2.clean.fq.gz [% END %]
SOAPnuke.run=1
SOAPnuke.afterscript=if [ ! -d $dir.report/1_QualityControl ];then mkdir $dir.report/1_QualityControl;fi <br/>\
	perl $tools.bin/qc.pl $dir.filter/$sample.name/Basic_Statistics_of_Sequencing_Quality.txt $dir.filter/$sample.name/Statistics_of_Filtered_Reads.txt $sample.name $dir.report/1_QualityControl
SOAPnuke.checkbefore= [% IF sample.library_type == "se" %] $dir.rRNA/${sample.name}_1.fq.gz [% ELSE %] $dir.rRNA/${sample.name}_1.fq.gz|$dir.rRNA/${sample.name}_2.fq.gz [% END %]
SOAPnuke.checkafter= \
        [% IF sample.library_type == "se" %] \
        $dir.filter/$sample.name/${sample.name}.clean.fq.gz \
        [% ELSE %] \
        $dir.filter/$sample.name/${sample.name}_1.clean.fq.gz|$dir.filter/$sample.name/${sample.name}_2.clean.fq.gz \
        [% END %]

SOAPnukestat=perl
SOAPnukestat.param=$tools.bin/filter.stat.pl $dir.filter $dir.filter/all.filter.stat.xls
SOAPnukestat.afterscript=cp $dir.filter/all.filter.stat.xls $dir.report/1_QualityControl <br/>\
	cp $config.readme/qc.readme.txt $dir.report/1_QualityControl/readme.txt
SOAPnukestat.type=combine
SOAPnukestat.prev=SOAPnuke

[align]
#Align
hisat_aln=$tools.hisat
hisat_aln.run=1
hisat_aln.param=$parameter.hisat \
	-x $config.hisat_genome_index \
	[% IF sample.library_type == "se" %] \
	-U $dir.filter/$sample.name/${sample.name}.clean.fq.gz \
	[% ELSE %] \
	-1 $dir.filter/$sample.name/${sample.name}_1.clean.fq.gz -2 $dir.filter/$sample.name/${sample.name}_2.clean.fq.gz \
	-S $dir.hisat/$sample.name/${sample.name}.sam 2> $dir.hisat/$sample.name/${sample.name}.align_summary.txt\
	[% END %]
hisat_aln.beforescript=if [ ! -d $dir.hisat/$sample.name ]; then mkdir $dir.hisat/$sample.name ; fi
hisat_aln.afterscript=if [ ! -d $dir.report/2_Align ];then mkdir $dir.report/2_Align;fi <br/>\
	samtools view -bS $dir.hisat/$sample.name/${sample.name}.sam > $dir.hisat/$sample.name/${sample.name}_unsorted.bam <br/>\
	samtools sort -@ 8 $dir.hisat/$sample.name/${sample.name}_unsorted.bam $dir.hisat/$sample.name/${sample.name} <br/>\
	samtools index $dir.hisat/$sample.name/${sample.name}.bam $dir.hisat/$sample.name/${sample.name}.bam.bai <br/>\
	perl $tools.bin/hisat2_align_stat.pl $dir.hisat/$sample.name/${sample.name}.align_summary.txt $sample.name $dir.hisat/${sample.name}.align_summary.xls <br/>\
	python $tools.RSeQC/inner_distance.py -i $dir.hisat/$sample.name/${sample.name}.bam -o $dir.hisat/$sample.name/$sample.name -r $config.bed <br/>\
	python $tools.RSeQC/read_distribution.py -i $dir.hisat/$sample.name/${sample.name}.bam -r $config.bed > $dir.hisat/$sample.name/${sample.name}.read_distribution.txt<br/>\
	perl $tools.bin/align.pl $dir.hisat/$sample.name/${sample.name}.read_distribution.txt $sample.name $dir.hisat/$sample.name<br/>\
	convert -density 300 $dir.hisat/$sample.name/${sample.name}.inner_distance_plot.pdf -resize 25% $dir.hisat/$sample.name/${sample.name}.inner_distance_plot.png <br/>\
	python $tools.RSeQC/infer_experiment.py -i $dir.hisat/$sample.name/${sample.name}.bam -r $config.bed > $dir.hisat/$sample.name/${sample.name}.strand_distribution.txt<br/>\
	python $tools.RSeQC/geneBody_coverage.py -i $dir.hisat/$sample.name/${sample.name}.bam -r $config.bed -o $dir.hisat/$sample.name/$sample.name<br/>\
	convert -density 300 $dir.hisat/$sample.name/${sample.name}.geneBodyCoverage.curves.pdf -resize 25% $dir.hisat/$sample.name/${sample.name}.geneBodyCoverage.curves.png<br/>\
	python $tools.RSeQC/RPKM_saturation.py -i $dir.hisat/$sample.name/${sample.name}.bam -r $config.bed -o $dir.hisat/$sample.name/${sample.name}.50bin -q 10 -s 2 -l 2<br/>\
	perl $tools.bin/saturation.pl $config.gene2tr $dir.hisat/$sample.name/${sample.name}.50bin.eRPKM.xls $sample.name $dir.hisat/$sample.name/${sample.name}.genenumber.txt<br/>\
	convert -density 300 $dir.hisat/$sample.name/${sample.name}.saturation.pdf -resize 25% $dir.hisat/$sample.name/${sample.name}.saturation.png<br/>\
	rm $dir.hisat/$sample.name/${sample.name}_unsorted.bam <br/>\
	rm $dir.hisat/$sample.name/${sample.name}.sam <br/>\
	cp $dir.hisat/$sample.name/${sample.name}.readDistribution.p* $dir.report/2_Align <br/>\
	cp $dir.hisat/$sample.name/${sample.name}.inner_distance_plot.p* $dir.report/2_Align<br/>\
	cp $dir.hisat/$sample.name/${sample.name}.geneBodyCoverage.curves.p* $dir.report/2_Align <br/>\
	cp $dir.hisat/$sample.name/${sample.name}.saturation.p* $dir.report/2_Align <br/>\
	cp $dir.hisat/$sample.name/${sample.name}.strand_distribution.txt $dir.report/2_Align<br/>\
	cp $config.readme/align.readme.txt $dir.report/2_Align/readme.txt
hisat_aln.checkbefore=$dir.filter/$sample.name/${sample.name}_1.clean.fq.gz |$dir.filter/$sample.name/${sample.name}_2.clean.fq.gz
hisat_aln.checkafter=$dir.hisat/$sample.name/${sample.name}.bam
hisat_aln.prev=SOAPnukestat

alignstat=perl
alignstat.param=$tools.bin/AllAlignStat.pl $dir.hisat $dir.hisat
alignstat.run=
alignstat.beforescript=
alignstat.afterscript=cp $dir.hisat/all.align.stat.xls $dir.report/2_Align/align.stat.combine.xls <br/>\
	perl $tools.bin/innerdistance.stat.pl $dir.hisat $dir.report/2_Align/all.insert.peak.xls
alignstat.checkbefore=
alignstat.checkafter=
alignstat.type=combine
alignstat.prev=hisat_aln

[ncRNA]
#assembly
stringtie=$tools.stringtie
stringtie.run=1
stringtie.param=$parameter.stringtie -G $config.gtf -o $dir.stringtie/$sample.name/${sample.name}.gtf -l $sample.name $dir.hisat/$sample.name/${sample.name}.bam
stringtie.beforescript=if [ ! -d $dir.stringtie/$sample.name ];then mkdir $dir.stringtie/$sample.name;fi 
stringtie.afterscript=if [ ! -d $dir.report/3_Assembly ]; then mkdir $dir.report/3_Assembly; fi <br/>\
	cp $dir.stringtie/$sample.name/${sample.name}.gtf $dir.report/3_Assembly <br/>\
	cp $config.readme/stringtie.readme.txt $dir.report/3_Assembly/readme.txt
stringtie.checkbefore=$dir.hisat/$sample.name/${sample.name}.bam
stringtie.checkafter=$dir.stringtie/$sample.name/${sample.name}.gtf
stringtie.prev=

gtffilter=$tools.bin/stringtie/Gtffilter.pl
gtffilter.run=1
gtffilter.script=perl 
gtffilter.param= -gtfdir $dir.stringtie -outdir $dir.ncRNA/1_gtffilter
gtffilter.beforescript=if [ ! -d $dir.ncRNA/1_gtffilter ]; then mkdir $dir.ncRNA/1_gtffilter;fi
gtffilter.afterscript=if [ ! -d $dir.report/4_LncRNAPrediction/1_gtffilter ]; then mkdir -p $dir.report/4_LncRNAPrediction/1_gtffilter;fi<br/>\
	cp $dir.ncRNA/1_gtffilter/*.transcript.gtf $dir.report/4_LncRNAPrediction/1_gtffilter <br/>\
	cp $config.readme/gtffilter.readme.txt $dir.report/4_LncRNAPrediction/1_gtffilter/readme.txt
gtffilter.checkbefore= \
    [% FOREACH sample IN combine.samples %] \
        $dir.stringtie/$sample.name/${sample.name}.gtf |\
    [% END %]
gtffilter.checkafter=[% FOREACH sample IN combine.samples %] $dir.ncRNA/1_gtffilter/${sample.name}.transcript.gtf |[% END %]
gtffilter.type=combine
gtffilter.prev=stringtie

cuffmerge=$tools.stringtie
cuffmerge.run= 1
cuffmerge.param = --merge -p 6 -G $config.gtf -o $dir.ncRNA/2_cuffmerge/merged.gtf $dir.ncRNA/1_gtffilter/filter.gtf.list<br/>\
	perl $tools.bin/mergeGtf.stat.pl $dir.ncRNA/2_cuffmerge/merged.gtf $dir.ncRNA/2_cuffmerge/merged.gtf.stat
cuffmerge.type=combine
cuffmerge.beforescript=if [ ! -d $dir.ncRNA/2_cuffmerge ]; then mkdir $dir.ncRNA/2_cuffmerge;fi
cuffmerge.afterscript=if [ ! -d $dir.report/4_LncRNAPrediction/2_cuffmerge ];then mkdir $dir.report/4_LncRNAPrediction/2_cuffmerge;fi<br/>\
	cp $dir.ncRNA/2_cuffmerge/merged.gtf $dir.report/4_LncRNAPrediction/2_cuffmerge <br/>\
	cp $config.readme/cuffmerge.readme.txt $dir.report/4_LncRNAPrediction/2_cuffmerge/readme.txt
cuffmerge.checkbefore=$dir.ncRNA/1_gtffilter/filter.gtf.list
cuffmerge.checkafter=$dir.ncRNA/2_cuffmerge/merged.gtf

gffcompare=$tools.gffcompare
gffcompare.run= 1
gffcompare.param =-r $config.refgtf -G -o $dir.ncRNA/3_gffcompare/cmp2ref $dir.ncRNA/2_cuffmerge/merged.gtf
gffcompare.beforescript=if [ ! -d $dir.ncRNA/3_gffcompare ]; then mkdir $dir.ncRNA/3_gffcompare;fi
gffcompare.afterscript=if [ ! -d $dir.report/4_LncRNAPrediction/3_gffcompare ]; then mkdir $dir.report/4_LncRNAPrediction/3_gffcompare;fi<br/>\
	cp $dir.ncRNA/3_gffcompare/cmp2ref.annotated.gtf $dir.report/4_LncRNAPrediction/3_gffcompare <br/>\
	cp $config.readme/cmp2ref.readme.txt $dir.report/4_LncRNAPrediction/3_gffcompare/readme.txt
gffcompare.type=combine
gffcompare.checkbefore=$dir.ncRNA/2_cuffmerge/merged.gtf
gffcompare.checkafter=$dir.ncRNA/3_gffcompare/cmp2ref.annotated.gtf

category=$tools.bin/stringtie/get_jioux_gtf.pl
category.run=1
category.script=perl
category.param=-cmp2ref $dir.ncRNA/3_gffcompare/cmp2ref.tracking -category j,i,o,u,x -ingtf $dir.ncRNA/2_cuffmerge/merged.gtf -outdir $dir.ncRNA/4_category -name jioux.merge.gtf
category.type=combine
category.beforescript=if [ ! -d $dir.ncRNA/4_category ];then mkdir $dir.ncRNA/4_category;fi
category.afterscript=if [ ! -d $dir.report/4_LncRNAPrediction/4_category ];then mkdir $dir.report/4_LncRNAPrediction/4_category;fi <br/>\
	cp $dir.ncRNA/4_category/jioux.merge.gtf $dir.report/4_LncRNAPrediction/4_category <br/>\
	cp $config.readme/category.readme.txt $dir.report/4_LncRNAPrediction/4_category/readme.txt
category.checkbefore=$dir.ncRNA/3_gffcompare/cmp2ref.tracking
category.checkafter=$dir.ncRNA/4_category/jioux.merge.gtf

le200bp=$tools.bin/extract_long_200bp.pl
le200bp.run=1
le200bp.script=perl
le200bp.param= $dir.ncRNA/5_le200nt/jioux.merge.bed >$dir.ncRNA/5_le200nt/jioux.merge.200bp.bed
le200bp.type=combine
le200bp.beforescript=if [ ! -d $dir.ncRNA/5_le200nt ]; then mkdir $dir.ncRNA/5_le200nt ;fi <br/>\
	perl $tools.bin/gtf2bed.pl $dir.ncRNA/4_category/jioux.merge.gtf > $dir.ncRNA/5_le200nt/jioux.merge.bed
le200bp.afterscript=perl $tools.bin/bed2fa.pl $config.genome $dir.ncRNA/5_le200nt/jioux.merge.200bp.bed $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa <br/>\
	if [ ! -d $dir.report/4_LncRNAPrediction/5_le200nt ];then mkdir $dir.report/4_LncRNAPrediction/5_le200nt;fi <br/>\
	perl $tools.bin/le200.stat.pl $dir.ncRNA/5_le200nt/jioux.merge.200bp.bed $dir.ncRNA/4_category/jioux.merge.gtf $dir.ncRNA/5_le200nt/jioux.merge.200bp.bed.stat <br/>\
	cp $dir.ncRNA/5_le200nt/jioux.merge.200bp.bed $dir.report/4_LncRNAPrediction/5_le200nt/ <br/>\
	cp $config.readme/le200.readme.txt $dir.report/4_LncRNAPrediction/5_le200nt/readme.txt
le200bp.checkbefore=$dir.ncRNA/4_category/jioux.merge.gtf
le200bp.checkafter=$dir.ncRNA/5_le200nt/jioux.merge.200bp.fa

blastnc=blastn
blastnc.run= 1
blastnc.param= $parameter.blastnc -db $config.noncode -query $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa -out $dir.ncRNA/6_blastnc/jioux.blastnc.out
blastnc.beforescript=if [ ! -d $dir.ncRNA/6_blastnc ];then mkdir $dir.ncRNA/6_blastnc;fi
blastnc.afterscript=perl $tools.bin/blast_parser.pl $dir.ncRNA/6_blastnc/jioux.blastnc.out >$dir.ncRNA/6_blastnc/jioux.blastnc.table <br/>\
	gzip -c $dir.ncRNA/6_blastnc/jioux.blastnc.out >$dir.ncRNA/6_blastnc/jioux.blastnc.out.gz <br/>\
	gzip -c $dir.ncRNA/6_blastnc/jioux.blastnc.table >$dir.ncRNA/6_blastnc/jioux.blastnc.table.gz <br/>\
	perl $tools.bin/filter_blast.pl -i $dir.ncRNA/6_blastnc/jioux.blastnc.table -s $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa -o $dir.ncRNA/6_blastnc/jioux.blastnc <br/>\
	grep '>' $dir.ncRNA/6_blastnc/jioux.blastnc_aligned.fa |  wc -l | awk '{print "align2KnownlncRNA""\t"\$1}' >$dir.ncRNA/6_blastnc/blastnc.stat.xls <br/>\
	grep '>' $dir.ncRNA/6_blastnc/jioux.blastnc_unaligned.fa  | wc -l | awk '{print "unalign2KnownlncRNA""\t"\$1}' >> $dir.ncRNA/6_blastnc/blastnc.stat.xls <br/>\
	if [ ! -d $dir.report/4_LncRNAPrediction/6_blastnc ];then mkdir $dir.report/4_LncRNAPrediction/6_blastnc;fi<br/>\
	cp $dir.ncRNA/6_blastnc/jioux.blastnc_filter.xls $dir.report/4_LncRNAPrediction/6_blastnc/ <br/>\
	cp $config.readme/blastnc.readme.txt $dir.report/4_LncRNAPrediction/6_blastnc/readme.txt
blastnc.type=combine
blastnc.checkbefore=$dir.ncRNA/5_le200nt/jioux.merge.200bp.fa
blastnc.checkafter=$dir.ncRNA/6_blastnc/jioux.blastnc_aligned.fa

transdecoder=$tools.transdecoder/TransDecoder
transdecoder.run=1
transdecoder.script=perl
transdecoder.param=-t $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa --train $config.cds \
-m 100 -S --search_pfam /DG/home/yut/database/Pfam/Pfam-AB.hmm.bin --outdir $dir.ncRNA/7_transdecoder --workdir $dir.ncRNA/7_transdecoder/transdecoder.tmp.pfam --CPU 4
transdecoder.type=combine
transdecoder.beforescript=if [ ! -d $dir.ncRNA/7_transdecoder ]; then mkdir $dir.ncRNA/7_transdecoder; fi
transdecoder.afterscript=perl $tools.bin/extract_no_cds.pl $dir.ncRNA/7_transdecoder/jioux.merge.200bp.fa.transdecoder.bed $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa $dir.ncRNA/7_transdecoder/jioux.nocds.fa <br/>\
	if [ ! -d $dir.report/4_LncRNAPrediction/7_transdecoder ];then mkdir $dir.report/4_LncRNAPrediction/7_transdecoder;fi<br/>\
	cp  $dir.ncRNA/7_transdecoder/jioux.merge.200bp.fa.transdecoder.bed $dir.report/4_LncRNAPrediction/7_transdecoder <br/>\
	cp $dir.ncRNA/7_transdecoder/jioux.merge.200bp.fa.transdecoder.cds $dir.report/4_LncRNAPrediction/7_transdecoder <br/>\
	cp $dir.ncRNA/7_transdecoder/jioux.merge.200bp.fa.transdecoder.gff3 $dir.report/4_LncRNAPrediction/7_transdecoder <br/>\
	cp $dir.ncRNA/7_transdecoder/jioux.merge.200bp.fa.transdecoder.pep $dir.report/4_LncRNAPrediction/7_transdecoder <br/>\
	cp $config.readme/transdecoder.readme.txt $dir.report/4_LncRNAPrediction/7_transdecoder/readme.txt
transdecoder.checkbefore=$dir.ncRNA/5_le200nt/jioux.merge.200bp.fa
transdecoder.checkafter=$dir.ncRNA/7_transdecoder/jioux.merge.200bp.fa.transdecoder.cds

blastnr=blastx
blastnr.run= 1
blastnr.param= $parameter.blastnr -db $config.nr -query $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa -out $dir.ncRNA/8_blastnr/jioux.blastnr.out
blastnr.beforescript=if [ ! -d $dir.ncRNA/8_blastnr ]; then mkdir $dir.ncRNA/8_blastnr ; fi
blastnr.afterscript=perl $tools.bin/blast_parser.pl $dir.ncRNA/8_blastnr/jioux.blastnr.out >$dir.ncRNA/8_blastnr/jioux.blastnr.table <br/>\
	gzip -c $dir.ncRNA/8_blastnr/jioux.blastnr.out >$dir.ncRNA/8_blastnr/jioux.blastnr.out.gz <br/>\
	gzip -c $dir.ncRNA/8_blastnr/jioux.blastnr.table >$dir.ncRNA/8_blastnr/jioux.blastnr.table.gz <br/>\
	perl $tools.bin/filter_blast.pl -i $dir.ncRNA/8_blastnr/jioux.blastnr.table -s $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa -o $dir.ncRNA/8_blastnr/jioux.blastnr <br/>\
	grep '>' $dir.ncRNA/8_blastnr/jioux.blastnr_aligned.fa | wc -l | awk '{print "align2Knownprotein""\t"\$1}' > $dir.ncRNA/8_blastnr/blastnr.stat.xls <br/>\
	grep '>' $dir.ncRNA/8_blastnr/jioux.blastnr_unaligned.fa | wc -l | awk '{print "unalign2Knownprotein""\t"\$1}' >> $dir.ncRNA/8_blastnr/blastnr.stat.xls <br/>\
	if [ ! -d $dir.report/4_LncRNAPrediction/8_blastnr ];then mkdir $dir.report/4_LncRNAPrediction/8_blastnr;fi<br/>\
	cp $dir.ncRNA/8_blastnr/jioux.blastnr_filter.xls $dir.report/4_LncRNAPrediction/8_blastnr <br/>\
	cp $config.readme/blastNr.readme.txt $dir.report/4_LncRNAPrediction/8_blastnr/readme.txt
blastnr.type=combine
blastnr.checkbefore=$dir.ncRNA/5_le200nt/jioux.merge.200bp.fa
blastnr.checkafter=$dir.ncRNA/8_blastnr/jioux.blastnr_aligned.fa

cpc=$tools.cpc
cpc.script=sh
cpc.param=$dir.ncRNA/5_le200nt/jioux.merge.200bp.fa $dir.ncRNA/9_cpc/cpc.check $dir.ncRNA/9_cpc/ncRNA_cpc $dir.ncRNA/9_cpc/cpc.evdence /DG/home/yut/database/uniport/20150906/uniprot_sprot.fasta
cpc.type=combine
cpc.beforescript=if [ ! -d $dir.ncRNA/9_cpc ];then mkdir $dir.ncRNA/9_cpc;fi <br/>\
	if [ ! -d $dir.report/4_LncRNAPrediction/9_cpc ];then mkdir $dir.report/4_LncRNAPrediction/9_cpc;fi <br/>\
	if [ ! -d $dir.ncRNA/9_cpc/ncRNA_cpc ];then mkdir $dir.ncRNA/9_cpc/ncRNA_cpc;fi <br/>\
	export PATH=/DG/home/yut/blast-2.2.26/bin:\$PATH
	cpc.afterscript=cp $dir.ncRNA/9_cpc/cpc.check $dir.report/4_LncRNAPrediction/9_cpc/cpc.txt <br/>\
	awk '\$4<0' $dir.ncRNA/9_cpc/cpc.check| wc -l | awk '{print "noncodingTrNum""\t"\$1}' > $dir.ncRNA/9_cpc/cpc.check.stat<br/>\
	awk '\$4>0' $dir.ncRNA/9_cpc/cpc.check| wc -l | awk '{print "codingTrNum""\t"\$1}' >> $dir.ncRNA/9_cpc/cpc.check.stat <br/>\
	cp $config.readme/cpc.readme.txt $dir.report/4_LncRNAPrediction/9_cpc/readme.txt
cpc.checkbefore=$dir.ncRNA/5_le200nt/jioux.merge.200bp.fa
cpc.checkafter=$dir.ncRNA/9_cpc/cpc.check

cpat=$tools.cpat/cpat.py
cpat.script=python 
cpat.run=1
cpat.param=-g $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa -d $parameter.cpat_logitModel -x $parameter.cpat_Hexamer -o $dir.ncRNA/9_cpat/cpat.txt
cpat.type=combine
cpat.beforescript=if [ ! -d $dir.ncRNA/9_cpat ];then mkdir $dir.ncRNA/9_cpat;fi
cpat.afterscript=perl $tools.bin/stringtie/get.cpat.nocds.gtf.pl $dir.ncRNA/9_cpat/cpat.txt $dir.ncRNA/2_cuffmerge/merged.gtf $parameter.cpat_cutoff $dir.ncRNA/9_cpat/novel.ncRNA.gtf <br/>\
	sed '1d' $dir.ncRNA/9_cpat/cpat.txt | awk '\$6<=$parameter.cpat_cutoff' | wc -l | awk '{print "noncodingTrNum""\t"\$1}' > $dir.ncRNA/9_cpat/cpat.stat.txt <br/>\
	sed '1d' $dir.ncRNA/9_cpat/cpat.txt | awk '\$6>$parameter.cpat_cutoff' | wc -l | awk '{print "codingTrNum""\t"\$1}' >> $dir.ncRNA/9_cpat/cpat.stat.txt <br/>\
	if [ ! -d $dir.report/4_LncRNAPrediction/9_cpat ]; then mkdir $dir.report/4_LncRNAPrediction/9_cpat;fi <br/>\
	cp $dir.ncRNA/9_cpat/cpat.txt $dir.report/4_LncRNAPrediction/9_cpat <br/>\
	cp $config.readme/cpat.readme.txt $dir.report/4_LncRNAPrediction/9_cpat/readme.txt
cpat.checkbefore=$dir.ncRNA/5_le200nt/jioux.merge.200bp.fa
cpat.checkafter=$dir.ncRNA/9_cpat/cpat.txt

novelNC=$tools.bin/novel_prediction.pl
novelNC.script=perl
novelNC.param=$dir.ncRNA/5_le200nt/jioux.merge.200bp.bed $dir.ncRNA/4_category/jioux.merge.gtf.cat $dir.ncRNA/6_blastnc/jioux.blastnc_filter.xls $dir.ncRNA/7_transdecoder/jioux.merge.200bp.fa.transdecoder.pfam.dat $dir.ncRNA/8_blastnr/jioux.blastnr_filter.xls $dir.ncRNA/9_cpat/cpat.txt $dir.ncRNA/9_cpc/cpc.check $dir.ncRNA/10_novel/novel_lncRNA.stat
novelNC.type=combine
novelNC.beforescript=if [ ! -d $dir.ncRNA/10_novel ];then mkdir $dir.ncRNA/10_novel;fi <br/>\
	if [ ! -d $dir.report/4_LncRNAPrediction/10_novel ];then mkdir $dir.report/4_LncRNAPrediction/10_novel;fi 
novelNC.afterscript=perl $tools.bin/novel_prediction.stat.pl $dir.ncRNA/10_novel/novel_lncRNA.stat $dir.ncRNA/10_novel/novel_lncRNA.stat.table $parameter.cpat_cutoff $dir.ncRNA/10_novel/novel_lncRNA.xls <br/>\
	perl $tools.bin/stringtie/get_gtf_by_id.pl $dir.ncRNA/10_novel/novel_lncRNA.xls $dir.ncRNA/2_cuffmerge/merged.gtf 1 $dir.ncRNA/10_novel/novel_lncRNA.gtf <br/>\
	cat $config.gtf $dir.ncRNA/10_novel/novel_lncRNA.gtf > $dir.exp/all.gtf <br/>\
	perl $tools.bin/stringtie/changestrandingtf.pl $dir.exp/all.gtf $dir.exp/all_changed.gtf <br/>\
	perl $tools.bin/extract_BED_by_id.pl $dir.ncRNA/10_novel/novel_lncRNA.xls 1 $dir.ncRNA/5_le200nt/jioux.merge.200bp.bed $dir.ncRNA/10_novel/novel_lncRNA.bed <br/>\
	perl $tools.bin/lengthByBed.pl $dir.ncRNA/10_novel/novel_lncRNA.bed $dir.ncRNA/10_novel/novel_lncRNA.tr.len <br/>\
	awk '{print \$10"\t"\$12}' $dir.ncRNA/10_novel/novel_lncRNA.gtf |sed 's/"//g' |sed 's/;//g' > $dir.ncRNA/10_novel/novel_lncRNA.gene2tr <br/>\
	awk '{print \$10"\t""-""\t""-""\t"\$1"\t""lncRNA""\t""-"}' $dir.ncRNA/10_novel/novel_lncRNA.gtf | sed 's/"//g' |sed 's/;//g' | sort -u > $dir.exp/novel_lncRNA.desc <br/>\
	cat $config.desc $dir.exp/novel_lncRNA.desc > $dir.exp/all.desc.txt <br/>\
	perl $tools.bin/getGeneMaxLen.pl $dir.ncRNA/10_novel/novel_lncRNA.tr.len $dir.ncRNA/10_novel/novel_lncRNA.gene2tr $dir.ncRNA/10_novel/novel_lncRNA.gene.len<br/>\
	cat $config.genelen $dir.ncRNA/10_novel/novel_lncRNA.gene.len >$dir.exp/all.gene.length.txt <br/>\
	perl $tools.bin/stringtie/gtf2exon.bed.pl $dir.ncRNA/10_novel/novel_lncRNA.gtf $dir.ncRNA/10_novel/novel_lncRNA.exon.bed <br/>\
	$tools.bwtool summary -keep-bed -with-sum $dir.ncRNA/10_novel/novel_lncRNA.exon.bed $config.bigwig $dir.ncRNA/10_novel/novel_lncRNA.exon.phylop.txt <br/>\
	perl $tools.bin/exon2tr.phylop.pl $dir.ncRNA/10_novel/novel_lncRNA.exon.phylop.txt $dir.ncRNA/10_novel/novel_lncRNA.transcript.phylop.txt <br/>\
	perl $tools.bin/R_plot/conservation/phyloP_boxplot.pl $config.protein_phylop,$dir.ncRNA/10_novel/novel_lncRNA.transcript.phylop.txt Protein,Novel $dir.ncRNA/10_novel <br/>\
	perl $tools.bin/getfaByID.pl $dir.ncRNA/5_le200nt/jioux.merge.200bp.fa $dir.ncRNA/10_novel/novel_lncRNA.bed 4 $dir.ncRNA/10_novel/novel_lncRNA.fa <br/>\
	perl $tools.bin/R_plot/len_boxplot.pl $config.probed,$config.lncRNAbed,$dir.ncRNA/10_novel/novel_lncRNA.bed Protein,LncRNA,Novel $dir.ncRNA/10_novel <br/>\
	perl $tools.bin/R_plot/exon_boxplot.pl $config.probed,$config.lncRNAbed,$dir.ncRNA/10_novel/novel_lncRNA.bed Protein,LncRNA,Novel $dir.ncRNA/10_novel <br/>\
	$tools.bedtools/coverageBed -s -a $config.rmsk -b $dir.ncRNA/10_novel/novel_lncRNA.exon.bed >$dir.ncRNA/10_novel/novel_lncRNA.exon.repeat.cov <br/>\
	perl $tools.bin/R_plot/repeat/get_repeat_frac.pl $dir.ncRNA/10_novel/novel_lncRNA.exon.repeat.cov $dir.ncRNA/10_novel/novel_lncRNA.repeat.frac.xls <br/>\
	perl $tools.bin/R_plot/repeat/repeat_boxplot.pl $config.protein_repeat,$config.lncRNA_repeat,$dir.ncRNA/10_novel/novel_lncRNA.repeat.frac.xls Protein,LncRNA,Novel $dir.ncRNA/10_novel <br/>\
	cp $dir.ncRNA/10_novel/repeat.boxplot.png $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $dir.ncRNA/10_novel/repeat.boxplot.pdf $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $dir.ncRNA/10_novel/novel_lncRNA.fa $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $dir.ncRNA/10_novel/novel_lncRNA.xls $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $dir.ncRNA/10_novel/novel_lncRNA.bed $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $dir.ncRNA/10_novel/novel_lncRNA.gtf $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $dir.ncRNA/10_novel/novel_lncRNA.stat.table $dir.report/4_LncRNAPrediction/10_novel/novel_lncRNA.stat.table.xls <br/>\
	cp $dir.ncRNA/10_novel/exon.boxplot.p* $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $dir.ncRNA/10_novel/len.boxplot.p* $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $dir.ncRNA/10_novel/phyloP.boxplot.p* $dir.report/4_LncRNAPrediction/10_novel <br/>\
	cp $config.readme/lncRNA.readme.txt $dir.report/4_LncRNAPrediction/10_novel/readme.txt
novelNC.checkbefore=$dir.ncRNA/9_cpat/cpat.txt | $dir.ncRNA/9_cpc/cpc.check
novelNC.checkafter=$dir.ncRNA/10_novel/novel_lncRNA.xls

[htseq]
htseq=$tools.htseq
htseq.param=$parameter.htseq $dir.hisat/$sample.name/${sample.name}.bam $dir.exp/all_changed.gtf >$dir.exp/${sample.name}.rawCount.txt
htseq.run=$config.htseqrun
htseq.beforescript=
htseq.afterscript=perl $tools.bin/stringtie/htseq2rpkm.pl $dir.hisat/$sample.name/${sample.name}.align_summary.txt $dir.exp/all.gene.length.txt $dir.exp/${sample.name}.rawCount.txt $sample.name $dir.exp/${sample.name}.rpkm.xls <br/>\
	sed 's/^/$sample.name\t/' $dir.exp/${sample.name}.rpkm.xls | sed '1d' > $dir.exp/${sample.name}.rpkm.tmp
htseq.checkbefore=$dir.ncRNA/10_novel/novel_lncRNA.gtf
htseq.checkafter=$dir.exp/${sample.name}.rpkm.xls
htseq.prev=

expstat=cat
expstat.param=$dir.exp/*.rpkm.tmp > $dir.exp/all.rpkm.tmp.xls
expstat.afterscript=if [ ! -d $dir.report/5_ExpressionQuantify ];then mkdir $dir.report/5_ExpressionQuantify;fi <br/>\
	perl $tools.bin/expr/rpkmplot.pl $dir.exp/all.rpkm.tmp.xls $dir.exp <br/>\
	rm $dir.exp/*tmp <br/>\
	perl $tools.bin/expr/mergerpkm1.pl $dir.exp $dir.exp/ <br/>\
	perl $tools.bin/expr/all.corStat.pl $dir.exp/all.sample.rpkm.cor.xls $dir.exp all.sample <br/>\
	perl $tools.bin/expr/mergerpkm2.pl $dir.exp $dir.exp <br/>\
	cp $dir.exp/all.sample.rpkm.boxplot.p* $dir.report/5_ExpressionQuantify <br/>\
	cp $dir.exp/all.sample.rpkm.density.p* $dir.report/5_ExpressionQuantify <br/>\
	cp $dir.exp/all.sample.exp.rpkm.xls $dir.report/5_ExpressionQuantify <br/>\
	head -n 5 $dir.exp/all.sample.exp.rpkm.xls > $dir.report/5_ExpressionQuantify/all.sample.exp.rpkm.xls.head5 <br/>\
	cp $dir.exp/all.sample.cor.person.p* $dir.report/5_ExpressionQuantify <br/>\
	cp $config.readme/exp.readme.txt $dir.report/5_ExpressionQuantify/readme.txt
expstat.checkbefore=
expstat.checkafter=
expstat.type=combine
expstat.prev=htseq

[RSEM]
RSEM.run=1
RSEM=$tools.bin/rsem-calculate-expression
RSEM.param=$parameter.rsem $dir.filter/${sample.name}_1.clean.fq $dir.filter/${sample.name}_2.clean.fq $dir.rsemindex/$config.species $dir.exp/$sample.name
RSEM.beforescript=$tools.rsem/rsem-prepare-reference --gtf $dir.exp/all.gtf --no-polyA $config.genome $dir.rsemindex/$config.species <br/>\
                  gunzip -c $dir.filter/${sample.name}_1.clean.fq.gz >$dir.filter/${sample.name}_1.clean.fq <br/>\
                  gunzip -c $dir.filter/${sample.name}_2.clean.fq.gz >$dir.filter/${sample.name}_2.clean.fq <br/>\
RSEM.afterscript=awk '{print $1"\t"$5}' $dir.exp/${sample.name}.genes.results >$dir.exp/${sample.name}.rawCount.txt 
RSEM.checkbefore=$dir.filter/${sample.name}_1.clean.fq.gz|$dir.filter/${sample.name}_2.clean.fq.gz
RSEM.checkafter=$dir.exp/${sample.name}.genes.results|$dir.exp/${sample.name}.isoforms.results
RSEM.prev=novelNC

[edgeR]
edgeR.run=1
edgeR=$tools.edgeR/run_DE_analysis.pl 
edgeR.script=perl
edgeR.param=--matrix $dir.diff/${group.name}.rawCount.xls --method edgeR --output $dir.diff \
[% name2=group.control %][% IF name2.match(",") %] --samples_file $dir.diff/${group.name}.samp.list \
[% ELSE %] --dispersion 0.05 [% END %]
edgeR.beforescript=if [ ! -d "$dir.report/6_DifferentialExpression" ];then mkdir $dir.report/6_DifferentialExpression; fi <br/>\
	perl $tools.bin/mergeHtseq.pl $dir.exp $group.control $group.case $group.control_group $group.case_group $group.name $dir.diff
edgeR.afterscript=perl $tools.bin/extract_sigDiffGene.pl $dir.diff/${group.name}.rawCount.xls.${group.control_group}_vs_${group.case_group}.edgeR.DE_results $dir.diff/${group.name}.diff.xls $dir.diff/${group.name}.sigDiff.xls $dir.diff/${group.name}.sigDiff.glist <br/>\
	perl $tools.bin/network/string.network.pl $config.taxid $dir.diff/${group.name}.sigDiff.xls 100 $dir.diff/ $group.name <br/>\
	convert $dir.diff/${group.name}.network.pdf $dir.report/6_DifferentialExpression/${group.name}.network.png <br/>\
	awk '{print \$1}' $dir.diff/${group.name}.sigDiff.glist > $dir.diff/${group.name}.sigDiff.rpkm.xls <br/>\
	perl $tools.bin/merge_rpkm.pl $dir.exp $group.control,$group.case $dir.diff $group.name <br/>\
	perl $tools.bin/addDesc.pl -input $dir.diff/${group.name}.diff.xls -desc $dir.diff/${group.name}.rpkm.xls -output $dir.diff/${group.name}.diff.rpkm.xls <br/>\
	perl $tools.bin/changeorder.pl $dir.diff/${group.name}.diff.rpkm.xls $dir.diff/${group.name}.diff.rpkm.tmp <br/>\
	mv $dir.diff/${group.name}.diff.rpkm.tmp $dir.diff/${group.name}.diff.rpkm.xls <br/>\
	perl $tools.bin/diff/rpkm2scattorPlot.pl $dir.diff/${group.name}.diff.rpkm.xls $group.control $group.case $group.control_group $group.case_group $dir.diff <br/>\
	perl $tools.bin/addDesc.pl -input $dir.diff/${group.name}.sigDiff.rpkm.xls -desc $dir.diff/${group.name}.rpkm.xls -output $dir.diff/${group.name}.sigDiff.rpkm.xls <br/>\
	perl $tools.bin/diff/heatmap.pl $dir.diff/${group.name}.sigDiff.rpkm.xls $group.name $dir.diff <br/>\
	perl $tools.bin/addDesc.pl -input $dir.diff/${group.name}.sigDiff.rpkm.xls -desc $dir.exp/all.desc.txt -output $dir.diff/${group.name}.sigDiff.rpkm.desc.xls <br/>\
	perl $tools.bin/addDesc.pl -input $dir.diff/${group.name}.diff.rpkm.xls -desc $dir.exp/all.desc.txt -output $dir.diff/${group.name}.diff.rpkm.desc.xls <br/>\
	cp $dir.diff/${group.name}.rawCount.xls.${group.control_group}_vs_${group.case_group}.edgeR.DE_results.MA_n_Volcano.pdf $dir.report/6_DifferentialExpression/${group.name}.edgeR.MA_n_Volcano.pdf <br/>\
	convert $dir.diff/${group.name}.rawCount.xls.${group.control_group}_vs_${group.case_group}.edgeR.DE_results.MA_n_Volcano.pdf $dir.diff/${group.name}.edgeR.MA_n_Volcano.png <br/>\
	awk -F "\t" '\$(NF-1)~/antisense/ || \$(NF-1)~/lincRNA/ || \$(NF-1)~/lncRNA/ || \$(NF-1)~/processed_transcript/ || \$(NF-1)~/sense/'  $dir.diff/${group.name}.sigDiff.rpkm.desc.xls | awk '{print \$1}' > $dir.diff/${group.name}.sigDiff.lncRNA.id <br/>\
	cp $dir.diff/${group.name}.sigDiff.rpkm.desc.xls $dir.report/6_DifferentialExpression <br/>\
	cp $dir.diff/${group.name}.diff.rpkm.desc.xls $dir.report/6_DifferentialExpression <br/>\
	cp $dir.diff/${group.name}.network.p* $dir.report/6_DifferentialExpression <br/>\
	cp $dir.diff/${group.name}.heatmap.p* $dir.report/6_DifferentialExpression <br/>\
	cp $dir.diff/${group.name}.edgeR.MA_n_Volcano.png $dir.report/6_DifferentialExpression <br/>\
	cp $dir.diff/*.GeneExp.p* $dir.report/6_DifferentialExpression/ <br/>\
	cp $config.readme/diff.readme.txt $dir.report/6_DifferentialExpression/readme.txt
edgeR.checkafter=$dir.exp/${group.name}.sigDiff.rpkm.desc.xls
edgeR.type=group
edgeR.prev=expstat

[DESeq]
DESeq.run=$config.DESeqrun
DESeq=$tools.bin/DESeq.v2.0.pl
DESeq.script=perl
DESeq.param=-indir $dir.exp -control $group.control -case $group.case -groupname $group.name -outdir $dir.exp
DESeq.afterscript=perl $tools.bin/get.sigdiffgeneid.pl $dir.exp/${group.name}.exp.sigDiff.xls $dir.kegg/${group.name}.sigDiff.glist
DESeq.checkbefore= [% FOREACH sample IN group.samples %] $dir.exp/${sample.name}.htseq.txt| [% END %]
DESeq.checkafter=$dir.exp/${group.name}.exp.diff.xls
DESeq.type=group
DESeq.prev=expstat

[function]
GO.run=1
GO=$tools.GO/functional.pl
GO.script=perl
GO.param=-go -glist $dir.diff/GO/${group.name}.glist -sdir $config.GO -species $config.species -outdir $dir.diff/GO
GO.beforescript=if [ ! -d $dir.diff/GO ]; then mkdir $dir.diff/GO;fi <br/>\
	if [ ! -d $dir.report/6_DifferentialExpression/GO ]; then mkdir $dir.report/6_DifferentialExpression/GO;fi <br/>\
	awk '{print \$1"\t"\$2}' $dir.diff/${group.name}.sigDiff.xls |grep -v 'GeneID' > $dir.diff/GO/${group.name}.glist
GO.afterscript=perl $tools.GO/drawGO.pl -indir $dir.diff -diff $group.name -outdir $dir.diff/GO -go $config.GO/$config.species -goclass /DG/home/yut/GO/go.class <br/>\
	cp $config.readme/go.readme.txt $dir.report/6_DifferentialExpression/GO/readme.txt <br/>\
	cp $dir.diff/GO/${group.name}.goclass.*g $dir.report/diff/GO <br/>\
	perl $tools.bin/diff/id2symbol.pl $dir.diff/GO/GO/${group.name}_C.txt 6 $config.desc $dir.report/6_DifferentialExpression/GO/${group.name}_C.xls <br/>\
	perl $tools.bin/diff/id2symbol.pl $dir.diff/GO/GO/${group.name}_F.txt 6 $config.desc $dir.report/6_DifferentialExpression/GO/${group.name}_F.xls <br/>\
	perl $tools.bin/diff/id2symbol.pl $dir.diff/GO/GO/${group.name}_P.txt 6 $config.desc $dir.report/6_DifferentialExpression/GO/${group.name}_P.xls
GO.type=group
GO.prev=

kegg=$tools.kobas/annotate.py
kegg.script=python
kegg.run=1
kegg.param=-i $dir.diff/${group.name}.sigdiff.kobas.glist $parameter.kobas_annot -o $dir.diff/KEGG/${group.name}.sigdiff.kobas.annot -n 4
kegg.beforescript=if [ ! -d $dir.diff/KEGG ]; then mkdir $dir.diff/KEGG;fi <br/>\
	if [ ! -d $dir.report/6_DifferentialExpression/KEGG ];then mkdir $dir.report/6_DifferentialExpression/KEGG;fi <br/>\
	awk '{print \$1}' $dir.diff/${group.name}.sigDiff.xls |grep -v 'GeneID' > $dir.diff/${group.name}.sigdiff.kobas.glist
	kegg.afterscript=python $tools.kobas/identify.py -f $dir.diff/KEGG/${group.name}.sigdiff.kobas.annot $parameter.kobas_identify -o $dir.diff/KEGG/${group.name}.sigdiff.kobas.txt <br/>\
	perl $tools.bin/diff/kobas.id2symbol.pl $dir.diff/KEGG/${group.name}.sigdiff.kobas.txt 7 $config.desc $dir.diff/KEGG/${group.name}.sigdiff.kobas.xls <br/>\
	perl $tools.bin/diff/kobas.path_picture.pl -i $dir.diff/KEGG/${group.name}.sigdiff.kobas.txt -n $group.name -o $dir.diff/KEGG <br/>\
	cp $dir.diff/KEGG/${group.name}.sigdiff.kobas.xls $dir.report/6_DifferentialExpression/KEGG <br/>\
	cp $dir.diff/KEGG/${group.name}.kegg.p* $dir.report/6_DifferentialExpression/KEGG <br/>\
	cp $config.readme/kegg.readme.txt $dir.report/6_DifferentialExpression/KEGG/readme.txt
kegg.checkafter=$dir.diff/KEGG/${group.name}.kegg.png | $dir.diff/KEGG/${group.name}.kegg.pdf
kegg.type=group
kegg.prev=

[trans]
lncRNA_trans=perl
lncRNA_trans.param=$tools.bin/addDesc.pl -input $dir.lncRNA_trans/all.sigDiff.lncRNA.id -desc $dir.exp/all.sample.rpkm.cor.xls -output $dir.lncRNA_trans/all.sigDiff.lncRNA.rpkm.xls
lncRNA_trans.beforescript=cat $dir.diff/*.sigDiff.lncRNA.id | sort -u |sed -e '1i GeneID' > $dir.lncRNA_trans/all.sigDiff.lncRNA.id <br/>\
	if [ ! -d $dir.lncRNA_trans/GO ]; then mkdir $dir.lncRNA_trans/GO;fi <br/>\
	if [ ! -d $dir.lncRNA_trans/KEGG ]; then mkdir $dir.lncRNA_trans/KEGG;fi <br/>\
	if [ ! -d $dir.report/8_LncRNA_trans ]; then mkdir $dir.report/8_LncRNA_trans;fi <br/>\
	if [ ! -d $dir.report/8_LncRNA_trans/GO ]; then mkdir $dir.report/8_LncRNA_trans/GO;fi <br/>\
	if [ ! -d $dir.report/8_LncRNA_trans/KEGG ]; then mkdir $dir.report/8_LncRNA_trans/KEGG;fi
lncRNA_trans.afterscript=perl $tools.bin/addDesc.pl -input $config.protein_id -desc $dir.exp/all.sample.rpkm.cor.xls -output $dir.lncRNA_trans/all.mRNA.rpkm.xls <br/>\
	perl $tools.bin/lncRNA_tran.pl $dir.lncRNA_trans/all.sigDiff.lncRNA.rpkm.xls $dir.lncRNA_trans/all.mRNA.rpkm.xls $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.txt <br/>\
	awk '\$3>=0.8 || \$3<=-0.8' $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.txt | awk '\$2<=0.05' | sed '1i mRNA\tp-value\tr\tlncRNA' > $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.txt <br/>\
	perl $tools.bin/addDesc.pl -input $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.txt -desc $config.desc -output $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.tmp1 <br/>\
	awk -F "\t" '{print \$4"\t"\$2"\t"\$3"\t"\$1"\t"\$5"\t"\$6"\t"\$7"\t"\$8"\t"\$9}' $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.tmp1 > $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.tmp2 <br/>\
	perl $tools.bin/addDesc.pl -input $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.tmp2 -desc $dir.exp/all.desc.txt -output $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.tmp3 <br/>\
	awk -F "\t" '{print \$1"\t"\$10"\t"\$11"\t"\$12"\t"\$13"\t"\$14"\t"\$2"\t"\$3"\t"\$4"\t"\$5"\t"\$6"\t"\$7"\t"\$8"\t"\$9}' $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.tmp3 > $dir.report/8_LncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.xls <br/>\
	awk '{if(\$1!~/mRNA/){print \$1}}' $dir.lncRNA_trans/sigDiff.lncRNA.mRNA.cor.filtered.txt |sort -u > $dir.lncRNA_trans/cor.mRNA.id <br/>\
	python $tools.kobas/annotate.py -i $dir.lncRNA_trans/cor.mRNA.id $parameter.kobas_annot -o $dir.lncRNA_trans/KEGG/lncRNA_correlated_mRNA.kobas.annot -n 4 <br/>\
	python $tools.kobas/identify.py -f $dir.lncRNA_trans/KEGG/lncRNA_correlated_mRNA.kobas.annot $parameter.kobas_identify -o $dir.lncRNA_trans/KEGG/lncRNA_correlated_mRNA.kobas.txt <br/>\
	perl $tools.bin/diff/kobas.id2symbol.pl $dir.lncRNA_trans/KEGG/lncRNA_correlated_mRNA.kobas.txt 7 $config.desc $dir.lncRNA_trans/KEGG/lncRNA_correlated_mRNA.kobas.xls <br/>\
	perl $tools.bin/diff/kobas.path_picture.pl -i $dir.lncRNA_trans/KEGG/lncRNA_correlated_mRNA.kobas.txt -n lncRNA_correlated_mRNA -o $dir.lncRNA_trans/KEGG <br/>\
	cp $dir.lncRNA_trans/KEGG/lncRNA_correlated_mRNA.kegg.p* $dir.report/8_LncRNA_trans/KEGG <br/>\
	cp $dir.lncRNA_trans/KEGG/lncRNA_correlated_mRNA.kobas.xls $dir.report/8_LncRNA_trans/KEGG <br/>\
	cp $config.readme/trans.readme.txt $dir.report/8_LncRNA_trans/readme.txt <br/>\
	cp $config.readme/trans.go.readme.txt $dir.report/8_LncRNA_trans/GO/readme.txt <br/>\
	cp $config.readme/trans.kegg.readme.txt $dir.report/8_LncRNA_trans/KEGG/readme.txt
lncRNA_trans.checkbefore=
lncRNA_trans.checkafter=
lncRNA_trans.type=combine
lncRNA_trans.prev=

[cis]
lncRNA_cis=perl
lncRNA_cis.param=$tools.bin/getid.pl $dir.lncRNA_cis/all.bed $dir.lncRNA_cis/all.sigDiff.lncRNA.tr.id 4 $dir.lncRNA_cis/all.sigDiff.lncRNA.bed
lncRNA_cis.beforescript=cat $dir.diff/*.sigDiff.lncRNA.id | sort -u > $dir.lncRNA_cis/all.sigDiff.lncRNA.id <br/>\
	cat $config.bed $dir.ncRNA/10_novel/novel_lncRNA.bed > $dir.lncRNA_cis/all.bed <br/>\
	cat $config.gene2tr $dir.ncRNA/10_novel/novel_lncRNA.gene2tr > $dir.lncRNA_cis/all.gene2tr <br/>\
	perl $tools.bin/getid.pl $dir.lncRNA_cis/all.gene2tr $dir.lncRNA_cis/all.sigDiff.lncRNA.id 1 $dir.lncRNA_cis/all.sigDiff.lncRNA.gene.tr.id <br/>\
	awk '{print \$2}' $dir.lncRNA_cis/all.sigDiff.lncRNA.gene.tr.id > $dir.lncRNA_cis/all.sigDiff.lncRNA.tr.id <br/>\
	if [ ! -d $dir.lncRNA_cis/GO ]; then mkdir $dir.lncRNA_cis/GO;fi <br/>\
	if [ ! -d $dir.lncRNA_cis/KEGG ]; then mkdir $dir.lncRNA_cis/KEGG;fi <br/>\
	if [ ! -d $dir.report/7_LncRNA_cis ]; then mkdir $dir.report/7_LncRNA_cis;fi <br/>\
	if [ ! -d $dir.report/7_LncRNA_cis/GO ]; then mkdir $dir.report/7_LncRNA_cis/GO;fi <br/>\
	if [ ! -d $dir.report/7_LncRNA_cis/KEGG ]; then mkdir $dir.report/7_LncRNA_cis/KEGG;fi
lncRNA_cis.afterscript=$tools.closestBed -s -D ref -id -t first -a $dir.lncRNA_cis/all.sigDiff.lncRNA.bed -b $config.probed > $dir.lncRNA_cis/all.sigDiff.lncRNA.up.txt <br/>\
	$tools.closestBed -s -D ref -iu -t first -a $dir.lncRNA_cis/all.sigDiff.lncRNA.bed -b $config.probed > $dir.lncRNA_cis/all.sigDiff.lncRNA.down.txt <br/>\
	awk '\$16~/\w+\d?/' $dir.lncRNA_cis/all.sigDiff.lncRNA.up.txt > $dir.lncRNA_cis/all.sigDiff.lncRNA.up.filtered.txt <br/>\
	awk '\$16~/\w+\d?/' $dir.lncRNA_cis/all.sigDiff.lncRNA.down.txt > $dir.lncRNA_cis/all.sigDiff.lncRNA.down.filtered.txt <br/>\
	awk '{print \$4"\t"\$16}' $dir.lncRNA_cis/all.sigDiff.lncRNA.up.filtered.txt > $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id <br/>\
	awk '{print \$4"\t"\$16}' $dir.lncRNA_cis/all.sigDiff.lncRNA.down.filtered.txt > $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id <br/>\
	perl $tools.bin/switchmark.pl -infile $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id -columns 1 --gene2mark $dir.lncRNA_cis/all.gene2tr -outdir $dir.lncRNA_cis -keyname all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp <br/>\
	perl $tools.bin/switchmark.pl -infile $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp -columns 2 --gene2mark $dir.lncRNA_cis/all.gene2tr -outdir $dir.lncRNA_cis -keyname all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp2 <br/>\
	sort -u $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp2 | sed '1i lncRNA\tup_stream_mRNA' > $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp3 <br/>\
	perl $tools.bin/addDesc.pl -input $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp3 -desc $dir.exp/all.desc.txt -output $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp4 <br/>\
	awk -F "\t" '{print \$2"\t"\$1"\t"\$3"\t"\$4"\t"\$5"\t"\$6"\t"\$7}' $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp4 > $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp5 <br/>\
	perl $tools.bin/addDesc.pl -input $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp5 -desc $dir.exp/all.desc.txt -output $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp6 <br/>\
	awk -F "\t" '{print \$2"\t"\$3"\t"\$4"\t"\$5"\t"\$6"\t"\$7"\t"\$1"\t"\$8"\t"\$9"\t"\$10"\t"\$11"\t"\$12}' $dir.lncRNA_cis/all.sigDiff.lncRNA.up.lncRNA.mRNA.tr.id.tmp6 > $dir.lncRNA_cis/up.lncRNA.mRNA.gene.xls <br/>\
	perl $tools.bin/switchmark.pl -infile $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id -columns 1 --gene2mark $dir.lncRNA_cis/all.gene2tr -outdir $dir.lncRNA_cis -keyname all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp <br/>\
	perl $tools.bin/switchmark.pl -infile $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp -columns 2 --gene2mark $dir.lncRNA_cis/all.gene2tr -outdir $dir.lncRNA_cis -keyname all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp2 <br/>\
	sort -u $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp2 | sed '1i lncRNA\tdown_stream_mRNA' > $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp3 <br/>\
	perl $tools.bin/addDesc.pl -input $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp3 -desc $dir.exp/all.desc.txt -output $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp4 <br/>\
	awk -F "\t" '{print \$2"\t"\$1"\t"\$3"\t"\$4"\t"\$5"\t"\$6"\t"\$7}' $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp4 > $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp5 <br/>\
	perl $tools.bin/addDesc.pl -input $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp5 -desc $dir.exp/all.desc.txt -output $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp6 <br/>\
	awk -F "\t" '{print \$2"\t"\$3"\t"\$4"\t"\$5"\t"\$6"\t"\$7"\t"\$1"\t"\$8"\t"\$9"\t"\$10"\t"\$11"\t"\$12}' $dir.lncRNA_cis/all.sigDiff.lncRNA.down.lncRNA.mRNA.tr.id.tmp6 > $dir.lncRNA_cis/down.lncRNA.mRNA.gene.xls <br/>\
	awk '{print \$16}' $dir.lncRNA_cis/all.sigDiff.lncRNA.up.filtered.txt > $dir.lncRNA_cis/all.sigDiff.lncRNA.up.mRNA.tr.id <br/>\
	awk '{print \$16}' $dir.lncRNA_cis/all.sigDiff.lncRNA.down.filtered.txt > $dir.lncRNA_cis/all.sigDiff.lncRNA.down.mRNA.tr.id <br/>\
	perl $tools.bin/getid.pl $config.protein_gene2tr $dir.lncRNA_cis/all.sigDiff.lncRNA.up.mRNA.tr.id 2 $dir.lncRNA_cis/all.sigDiff.lncRNA.up.mRNA.gene.tr.id <br/>\
	awk '{print \$1}' $dir.lncRNA_cis/all.sigDiff.lncRNA.up.mRNA.gene.tr.id | sort -u > $dir.lncRNA_cis/all.sigDiff.lncRNA.up.mRNA.gene.id <br/>\
	perl $tools.bin/getid.pl $config.protein_gene2tr $dir.lncRNA_cis/all.sigDiff.lncRNA.down.mRNA.tr.id 2 $dir.lncRNA_cis/all.sigDiff.lncRNA.down.mRNA.gene.tr.id <br/>\
	awk '{print \$1}' $dir.lncRNA_cis/all.sigDiff.lncRNA.down.mRNA.gene.tr.id | sort -u > $dir.lncRNA_cis/all.sigDiff.lncRNA.down.mRNA.gene.id <br/>\
	python $tools.kobas/annotate.py -i $dir.lncRNA_cis/all.sigDiff.lncRNA.up.mRNA.gene.id $parameter.kobas_annot -o $dir.lncRNA_cis/KEGG/up.mRNA.annot -n 4 <br/>\
	python $tools.kobas/identify.py -f $dir.lncRNA_cis/KEGG/up.mRNA.annot $parameter.kobas_identify -o $dir.lncRNA_cis/KEGG/up.mRNA.kobas.txt <br/>\
	perl $tools.bin/diff/kobas.id2symbol.pl $dir.lncRNA_cis/KEGG/up.mRNA.kobas.txt 7 $config.desc $dir.lncRNA_cis/KEGG/up.mRNA.kobas.xls <br/>\
	perl $tools.bin/diff/kobas.path_picture.pl -i $dir.lncRNA_cis/KEGG/up.mRNA.kobas.txt -n up.mRNA -o $dir.lncRNA_cis/KEGG <br/>\
	python $tools.kobas/annotate.py -i $dir.lncRNA_cis/all.sigDiff.lncRNA.down.mRNA.gene.id $parameter.kobas_annot -o $dir.lncRNA_cis/KEGG/down.mRNA.annot -n 4 <br/>\
	python $tools.kobas/identify.py -f $dir.lncRNA_cis/KEGG/down.mRNA.annot $parameter.kobas_identify -o $dir.lncRNA_cis/KEGG/down.mRNA.kobas.txt <br/>\
	perl $tools.bin/diff/kobas.id2symbol.pl $dir.lncRNA_cis/KEGG/down.mRNA.kobas.txt 7 $config.desc $dir.lncRNA_cis/KEGG/down.mRNA.kobas.xls <br/>\
	perl $tools.bin/diff/kobas.path_picture.pl -i $dir.lncRNA_cis/KEGG/down.mRNA.kobas.txt -n down.mRNA -o $dir.lncRNA_cis/KEGG <br/>\
	cp $config.readme/cis.go.readme.txt $dir.report/7_LncRNA_cis/GO/readme.txt <br/>\
	cp $dir.lncRNA_cis/KEGG/*.mRNA.kobas.xls $dir.report/7_LncRNA_cis/KEGG <br/>\
	cp $dir.lncRNA_cis/KEGG/*.mRNA.kegg.p* $dir.report/7_LncRNA_cis/KEGG <br/>\
	cp $dir.lncRNA_cis/up.lncRNA.mRNA.gene.xls $dir.report/7_LncRNA_cis <br/>\
	cp $dir.lncRNA_cis/down.lncRNA.mRNA.gene.xls $dir.report/7_LncRNA_cis <br/>\
	cp $config.readme/cis.readme.txt $dir.report/7_LncRNA_cis/readme.txt <br/>\
	cp $config.readme/cis.kegg.readme.txt $dir.report/7_LncRNA_cis/KEGG/readme.txt
lncRNA_cis.checkbefore=
lncRNA_cis.checkafter=
lncRNA_cis.type=combine
lncRNA_cis.prev=

[as]
#AS
rMATs=$tools.bin/rmatsh_hisat.pl
rMATs.script=perl
rMATs.run=1
rMATs.param=$dir.hisat $group.control $group.case $config.gtf $dir.as $group.name $dir.outDir/bin/${group.name}.rMATS.sh
rMATs.beforescript=if [ ! -d $dir.as/$group.name ]; then mkdir $dir.as/$group.name;fi <br/>\
if [ ! -d $dir.report/9_AlternativeSplicing ]; then mkdir $dir.report/9_AlternativeSplicing;fi
rMATs.afterscript=sh $dir.outDir/bin/${group.name}.rMATS.sh <br/>\
	perl $tools.bin/AS.stat.pl $dir.as/$group.name/summary.txt $group.name $dir.as/$group.name <br/>\
	cp $dir.as/$group.name/${group.name}.as.event.stat.xls $dir.report/9_AlternativeSplicing <br/>\
	cp $dir.as/$group.name/${group.name}.AS.p* $dir.report/9_AlternativeSplicing <br/>\
	cp $dir.as/$group.name/MATS_output/A3SS.MATS.JunctionCountOnly.txt $dir.report/9_AlternativeSplicing/${group.name}.A3SS.MATS.JunctionCountOnly.txt <br/>\
	cp $dir.as/$group.name/MATS_output/A3SS.MATS.ReadsOnTargetAndJunctionCounts.txt $dir.report/9_AlternativeSplicing/${group.name}.A3SS.MATS.ReadsOnTargetAndJunctionCounts.txt <br/>\
	cp $dir.as/$group.name/MATS_output/A5SS.MATS.JunctionCountOnly.txt $dir.report/9_AlternativeSplicing/${group.name}.A5SS.MATS.JunctionCountOnly.txt <br/>\
	cp $dir.as/$group.name/MATS_output/A5SS.MATS.ReadsOnTargetAndJunctionCounts.txt $dir.report/9_AlternativeSplicing/${group.name}.A5SS.MATS.ReadsOnTargetAndJunctionCounts.txt <br/>\
	cp $dir.as/$group.name/MATS_output/MXE.MATS.JunctionCountOnly.txt $dir.report/9_AlternativeSplicing/${group.name}.MXE.MATS.JunctionCountOnly.txt <br/>\
	cp $dir.as/$group.name/MATS_output/MXE.MATS.ReadsOnTargetAndJunctionCounts.txt $dir.report/9_AlternativeSplicing/${group.name}.MXE.MATS.ReadsOnTargetAndJunctionCounts.txt <br/>\
	cp $dir.as/$group.name/MATS_output/RI.MATS.JunctionCountOnly.txt $dir.report/9_AlternativeSplicing/${group.name}.RI.MATS.JunctionCountOnly.txt <br/>\
	cp $dir.as/$group.name/MATS_output/RI.MATS.ReadsOnTargetAndJunctionCounts.txt $dir.report/9_AlternativeSplicing/${group.name}.RI.MATS.ReadsOnTargetAndJunctionCounts.txt <br/>\
	cp $dir.as/$group.name/MATS_output/SE.MATS.JunctionCountOnly.txt $dir.report/9_AlternativeSplicing/${group.name}.SE.MATS.JunctionCountOnly.txt <br/>\
	cp $dir.as/$group.name/MATS_output/SE.MATS.ReadsOnTargetAndJunctionCounts.txt $dir.report/9_AlternativeSplicing/${group.name}.SE.MATS.ReadsOnTargetAndJunctionCounts.txt <br/>\
	cp $config.readme/as.readme.txt $dir.report/9_AlternativeSplicing/readme.txt
rMATs.checkafter=$dir.as/$group.name/${group.name}.AS.png | $dir.as/$group.name/${group.name}.AS.pdf
rMATs.type=group
rMATs.prev=htseq

[SNP]
STAR1pass=$tools.STAR
STAR1pass.run=$config.SNPrun
STAR1pass.param=--genomeDir $config.starDatabase --readFilesIn $dir.filter/$sample.name/${sample.name}_1.clean.fq.gz $dir.filter/$sample.name/${sample.name}_2.clean.fq.gz --outFileNamePrefix $dir.star1pass/${sample.name}. --runThreadN 4 --alignMatesGapMax alignIntronMax --readFilesCommand zcat
STAR1pass.checkbefore=$config.starDatabase/Genome
STAR1pass.checkafter=$dir.star1pass/${sample.name}.Aligned.out.sam
STAR1pass.prev=SOAPnuke

STAR2pass=$tools.STAR
STAR2pass.run=$config.SNPrun
STAR2pass.param=--genomeDir $dir.star2Database --readFilesIn $dir.filter/$sample.name/${sample.name}_1.clean.fq.gz $dir.filter/$sample.name/${sample.name}_2.clean.fq.gz --outFileNamePrefix $dir.star2pass/${sample.name}. --runThreadN 4 --alignMatesGapMax alignIntronMax --readFilesCommand zcat
STAR2pass.checkbefore=$dir.star2Database/Genome
STAR2pass.checkafter=$dir.star2pass/${sample.name}.Aligned.out.sam
STAR2pass.prev=STAR2database

splitBam=$tools.picard/MarkDuplicates.jar
splitBam.script=java -Xmx5G -jar
splitBam.run=$config.SNPrun
splitBam.param= INPUT=$dir.gatk/${sample.name}.rg_add_sort.bam OUTPUT=$dir.gatk/${sample.name}.dedup.bam METRICS_FILE=$dir.gatk/${sample.name}.dedup.metrics CREATE_INDEX=true VALIDATION_STRINGENCY=SILENT
splitBam.beforescript=java -Xmx5G -jar $tools.picard/AddOrReplaceReadGroups.jar I=$dir.star2pass/${sample.name}.Aligned.out.sam \
O=$dir.gatk/${sample.name}.rg_add_sort.bam SO=coordinate ID=$sample.name SM=$sample.name LB=lncRNA PL=illumina PU=${sample.name}_lncRNA CN=dg TMP_DIR=$dir.gatk/${sample.name}.tmp
splitBam.afterscript=java -Xmx8G -jar $tools.GATK/GenomeAnalysisTK.jar -T SplitNCigarReads -I $dir.gatk/${sample.name}.dedup.bam -R $config.snp_genome -o $dir.gatk/${sample.name}.split.bam -rf ReassignMappingQuality -DMQ 60 -U ALLOW_N_CIGAR_READS  
splitBam.checkbefore=$dir.star2pass/${sample.name}.Aligned.out.sam
splitBam.checkafter=$dir.gatk/${sample.name}.split.bam
splitBam.prev=STAR2pass

baseRecall=$tools.GATK/GenomeAnalysisTK.jar
baseRecall.script=java -Xmx15G -jar
baseReall.run=$config.SNPrun
baseRecall.param=-T IndelRealigner -filterNoBases -R $config.snp_genome -I $dir.gatk/${sample.name}.split.bam -targetIntervals $dir.gatk/${sample.name}.realign.intervals -o $dir.gatk/${sample.name}.realign.bam -known $config.indel1 -known $config.indel2
baseRecall.beforescript=java -Xmx15G -jar $tools.GATK/GenomeAnalysisTK.jar -T RealignerTargetCreator -R $config.snp_genome \
-o $dir.gatk/${sample.name}.realign.intervals -I $dir.gatk/${sample.name}.split.bam -known $config.indel1 -known $config.indel2
baseRecall.afterscript=java -Xmx15G -jar $tools.GATK/GenomeAnalysisTK.jar -T BaseRecalibrator -R $config.snp_genome \
-I $dir.gatk/${sample.name}.realign.bam -knownSites $config.dbsnp137 -knownSites $config.indel1 -knownSites $config.indel2 -o $dir.gatk/${sample.name}.recal.table <br/>\
	java -Xmx15G -jar $tools.GATK/GenomeAnalysisTK.jar -T PrintReads -R $config.snp_genome -I $dir.gatk/${sample.name}.realign.bam \
-BQSR $dir.gatk/${sample.name}.recal.table -o $dir.gatk/${sample.name}.baseRecall.bam
baseRecall.checkbefore=$dir.gatk/${sample.name}.split.bam
baseRecall.checkafter=$dir.gatk/${sample.name}.baseRecall.bam
baseRecall.prev=splitBam

snpCalling=$tools.GATK/GenomeAnalysisTK.jar
snpCalling.script=java -Xmx15G -jar
snpCalling.run=$config.SNPrun
snpCalling.param=-l INFO -T HaplotypeCaller -R $config.snp_genome -I $dir.gatk/${sample.name}.baseRecall.bam --dbsnp $config.dbsnp137 -recoverDanglingHeads -dontUseSoftClippedBases -stand_call_conf 20.0 -stand_emit_conf 10.0 -o $dir.snp/${sample.name}.snp.indel.vcf -A Coverage -A RMSMappingQuality
snpCalling.checkbefore=$dir.gatk/${sample.name}.baseRecall.bam
snpCalling.checkafter=$dir.snp/${sample.name}.snp.indel.vcf
snpCalling.prev=baseRecall

snpFilter=$tools.GATK/GenomeAnalysisTK.jar
snpFilter.script=java -Xmx15G -jar
snpFilter.run=$config.SNPrun
snpFilter.param=-T VariantFiltration -R $config.snp_genome -V $dir.snp/${sample.name}.snp.vcf -window 35 -cluster 3 -filterName FS -filter "FS > 30.0" -filterName QD -filter "QD < 2.0" -filterName "LowCoverage" -filter "DP <4" -o $dir.snp/${sample.name}.filter.snp.vcf
snpFilter.beforescript=java -Xmx5G -jar $tools.GATK/GenomeAnalysisTK.jar -l INFO -T SelectVariants -R $config.snp_genome -V $dir.snp/${sample.name}.snp.indel.vcf -selectType SNP -o $dir.snp/${sample.name}.snp.vcf
snpFilter.afterscript=grep '^#' $dir.snp/${sample.name}.filter.snp.vcf >$dir.snp/${sample.name}.pass.snp.vcf <br/>\
	awk '\$7~/PASS/' $dir.snp/${sample.name}.filter.snp.vcf >>$dir.snp/${sample.name}.pass.snp.vcf <br/>\
	perl $tools.bin/filt_vcf.pl -i $dir.snp/${sample.name}.pass.snp.vcf -p $config.psl -e 4 -o $dir.snp/${sample.name}.pass.intron.snp.vcf <br/>\
	$tools.bedtools/bedtools intersect -a $dir.snp/${sample.name}.pass.intron.snp.vcf -b $config.rmsk -v -header >$dir.snp/${sample.name}.rmRepeat.snp.vcf <br/>\
	$tools.bedtools/bedtools intersect -a $dir.snp/${sample.name}.rmRepeat.snp.vcf -b $config.editSite -v -header >$dir.snp/${sample.name}.final.snp.vcf <br/>\
	perl $tools.annovar/convert2annovar.pl -format vcf4 --withzyg --includeinfo $dir.snp/${sample.name}.final.snp.vcf >$dir.snp/${sample.name}.snp.annovar <br/>\
	perl $tools.annovar/table_annovar.pl --remove --otherinfo --csvout --buildver $config.species -protocol refGene,phastConsElements46way,genomicSuperDups,esp6500si_all,1000g2015aug_all,snp137,avsift,ljb2_pp2hdiv,ljb2_mt,ljb2_lrt -operation g,r,r,f,f,f,f,f,f,f $dir.snp/${sample.name}.snp.annovar $config.annovarDB --outfile $dir.snp/$sample.name <br/>\
	perl $tools.bin/snp/Annovar_stat_for_all.pl -i $dir.snp/${sample.name}.${config.species}_multianno.csv -s $sample.name -o $dir.snp/${sample.name}.snp -t 0.05 -v snp <br/>\
	if [ ! -d $dir.report/10_SNPCalling ];then mkdir $dir.report/10_SNPCalling;fi <br/>\
	cp $dir.snp/${sample.name}.final.snp.vcf $dir.report/10_SNPCalling/ <br/>\
	cp $dir.snp/${sample.name}.${config.species}_multianno.csv $dir.report/10_SNPCalling/ <br/>\
	cp $dir.snp/${sample.name}.snp.all_stat $dir.report/10_SNPCalling/${sample.name}.snp.all_stat.xls <br/>\
	cp $dir.snp/${sample.name}.snp.novel_stat $dir.report/10_SNPCalling/${sample.name}.snp.novel_stat.xls <br/>\
	cp $config.readme/snp.readme.txt $dir.report/10_SNPCalling/readme.txt <br/>\
	perl $tools.bin/circos.pl -i $dir.snp/${sample.name}.${config.species}_multianno.csv -dir $dir.snp -o $sample.name <br/>\
	cp $dir.snp/${sample.name}.circos.svg $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/${sample.name}.circos.png $dir.report/10_SNPCalling
snpFilter.checkbefore=$dir.snp/${sample.name}.snp.indel.vcf
snpFilter.checkafter=$dir.snp/${sample.name}.${config.species}_multianno.csv

STAR2database=$tools.STAR
STAR2database.param=--runMode genomeGenerate --genomeDir $dir.star2Database --genomeFastaFiles $config.genome --runThreadN 4 --sjdbFileChrStartEnd $dir.star2Database/all.SJ.out.tab --sjdbOverhang 149
STAR2database.run=$config.SNPrun
STAR2database.beforescript=cat $dir.star1pass/*.SJ.out.tab >$dir.star2Database/all.SJ.out.tab
STAR2database.checkbefore=[% FOREACH sample IN combine.samples %] $dir.star1pass/${sample.name}.SJ.out.tab | [% END %]
STAR2database.checkafter=$dir.star2Database/Genome
STAR2database.type=combine
STAR2database.prev=STAR1pass

snpPlot=perl
snpPlot.param=$tools.bin/snp/SNP_all_stat.pl $dir.snp $dir.snp $dir.snp/SNP.region.txt <br/>\
	perl $tools.bin/snp/snp_chr_distribution.pl $dir.snp $dir.snp <br/>\
	perl $tools.bin/snp/snp_type_distribution.pl $dir.snp $dir.snp
snpPlot.run=$config.SNPrun
snpPlot.beforescript=
snpPlot.afterscript=if [ ! -d $dir.report/10_SNPCalling ];then mkdir $dir.report/10_SNPCalling;fi <br/>\
	cp $dir.snp/snp_type.png $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/snp_dis.png $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/SNP.region.png $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/snp_type.pdf $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/snp_dis.pdf $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/SNP.region.pdf $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/snp_type_dis.xls $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/snp_dis.xls $dir.report/10_SNPCalling <br/>\
	cp $dir.snp/SNP.all.stat.xls $dir.report/10_SNPCalling <br/>\
	cp $config.readme/snp.readme.txt $dir.report/10_SNPCalling/readme.txt
snpPlot.checkbefore=[% FOREACH sample IN combine.samples %] $dir.snp/${sample.name}.${config.species}_multianno.csv | [% END %]
snpPlot.checkafter=$dir.snp/snp_type.png | $dir.snp/snp_dis.png |$dir.snp/SNP.region.png
snpPlot.type=combine
snpPlot.prev=snpFilter

[RNAediting]
RNAediting=$tools.reditools/REDItoolBlatCorrection.py
RNAediting.script=python
RNAediting.run=$config.RNAeditRun
RNAediting.param=-i $dir.gatk/${sample.name}.baseRecall.bam -f $config.snp_genome -o $dir.RNAediting/$sample.name $parameter.redi -P $config.splicesite
RNAediting.beforescript=if [ ! -d $dir.RNAediting ];then mkdir $dir.RNAediting;fi
RNAediting.afterscript=mv $dir.RNAediting/$sample.name/denovo_*/* $dir.RNAediting/$sample.name/ <br/>\
	mv $dir.RNAediting/$sample.name/outTable_* $dir.RNAediting/$sample.name/${sample.name}.outTable <br/>\
	mv $dir.RNAediting/$sample.name/outTableSig_* $dir.RNAediting/$sample.name/${sample.name}.outTableSig <br/>\
	python $tools.reditools/AnnotateTable.py -a $config.dbsnpGtf -i $dir.RNAediting/$sample.name/${sample.name}.outTableSig -s 7 -u -c 1,2 -n SNP -o $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp <br/>\
	python $tools.reditools/AnnotateTable.py -a $config.repmask -i $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp -s 7 -u -c 1,2,3 -n RepMask -o $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp.repmask <br/>\
	python $tools.reditools/AnnotateTable.py -a $config.refgene -i $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp.repmask -s 7 -u -c 1,2 -n refSeq -o $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp.repmask.refSeq <br/>\
	python $tools.reditools/AnnotateTable.py -a $config.radar -i $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp.repmask.refSeq -s 7 -u -c 1 -n RADAR -o $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp.repmask.refSeq.radar <br/>\
	head -1 $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp.repmask.refSeq.radar >$dir.RNAediting/$sample.name/${sample.name}.head <br/>\
	awk -F "\t" '\$9 <0.95 && \$11 !~ "snp"' $dir.RNAediting/$sample.name/${sample.name}.outTableSig.snp.repmask.refSeq.radar >$dir.RNAediting/$sample.name/${sample.name}.edit.filter.nohead.xls <br/>\
	cat $dir.RNAediting/$sample.name/${sample.name}.head $dir.RNAediting/$sample.name/${sample.name}.edit.filter.nohead.xls >$dir.RNAediting/$sample.name/${sample.name}.edit.filter.xls <br/>\
	perl $tools.bin/RNAediting/redi2annovar.pl $dir.RNAediting/$sample.name/${sample.name}.edit.filter.nohead.xls $dir.RNAediting/$sample.name/${sample.name}.edit.filter2annovar <br/>\
	perl $tools.annovar/table_annovar.pl --remove --otherinfo --buildver hg19 -protocol refGene,phastConsElements46way,genomicSuperDups,avsift,ljb2_pp2hdiv,ljb2_mt,ljb2_lrt -operation g,r,r,f,f,f,f $dir.RNAediting/$sample.name/${sample.name}.edit.filter2annovar $config.annovarDB --outfile $dir.RNAediting/$sample.name/${sample.name}.edit.filter.annovar<br/>\
	perl $tools.bin/RNAediting/RNAedit.statistic.pl $dir.RNAediting/$sample.name/${sample.name}.edit.filter.annovar.hg19_multianno.txt $dir.RNAediting/$sample.name $sample.name <br/>\
	perl $tools.bin/RNAediting/get.AG.pos.fa.pl $config.snp_genome $dir.RNAediting/$sample.name/${sample.name}.edit.xls $dir.RNAediting/$sample.name/${sample.name}.AG.edit.fa<br/>\
	perl $tools.weblogo/weblogo -f $dir.RNAediting/$sample.name/${sample.name}.AG.edit.fa -o $dir.RNAediting/$sample.name/${sample.name}.AG.edit.weblogo.png -F png --resolution 600 -c "classic" -s medium   --fineprint " " --annotate "-5,-4,-3,-2,-1,0,1,2,3,4,5" -U probability <br/>\
	awk -F "\t" '{print \$11}' $dir.RNAediting/$sample.name/${sample.name}.edit.xls |grep -v "Frequency" |awk '{print $sample.name"\t"\$1}' >$dir.RNAediting/$sample.name/${sample.name}.editing_level.txt
RNAediting.checkbefore=$dir.gatk/${sample.name}.baseRecall.bam
RNAediting.checkafter=$dir.RNAediting/$sample.name/${sample.name}.edit.xls
RNAediting.prev=baseRecall

RNAeditPlot=$tools.bin/RNAediting/editing.level.pl
RNAeditPlot.script=perl
RNAeditPlot.param=$dir.RNAediting $dir.RNAediting
RNAeditPlot.run=$config.RNAeditRun
RNAeditPlot.beforescript=
RNAeditPlot.afterscript=if [ ! -d $dir.report/11_RNAediting ];then mkdir $dir.report/11_RNAediting;fi <br/>\
	cp $dir.RNAediting/editing_level.png $dir.report/11_RNAediting <br/>\
	perl $tools.bin/RNAediting/edit.pos.stat.pl $dir.RNAediting $dir.report/11_RNAediting/edit.pos.txt <br/>\
	perl $tools.bin/RNAediting/edit.rep.stat.pl $dir.RNAediting $dir.report/11_RNAediting/edit.rep.txt <br/>\
	perl $tools.bin/RNAediting/edit.type.stat.pl $dir.RNAediting $dir.report/11_RNAediting/edit.type.txt <br/>\
	cp $config.readme/rnaedit.readme.txt $dir.report/11_RNAediting/readme.txt
RNAeditPlot.checkbefore=[% FOREACH sample IN combine.samples %] $dir.RNAediting/${sample.name}.editing_level.txt | [% END %]
RNAeditPlot.checkafter=$dir.RNAediting/editing_level.txt | $dir.RNAediting/editing_level.png
RNAeditPlot.type=combine
RNAeditPlot.prev=RNAediting

[circRNA]
#mapping
bwa=$tools.bwa
bwa.run=1
bwa.param=$parameter.bwa $config.bwa_index $dir.filter/$sample.name/${sample.name}_1.clean.fq.gz $dir.filter/$sample.name/${sample.name}_2.clean.fq.gz > $dir.bwa/$sample.name/${sample.name}_aln.sam
bwa.beforescript=if [ ! -d $dir.bwa/$sample.name ]; then mkdir $dir.bwa/$sample.name ; fi
bwa.afterscript=
bwa.checkbefore=$dir.filter/$sample.name/${sample.name}_1.clean.fq.gz |$dir.filter/$sample.name/${sample.name}_2.clean.fq.gz
bwa.checkafter=$dir.bwa/$sample.name/${sample.name}_aln.sam
bwa.prev=

#find circRNA_CIRI
ciri=$tools.ciri
ciri.run=1
ciri.param=$parameter.ciri -I $dir.bwa/$sample.name/${sample.name}_aln.sam -O $dir.circRNA/$sample.name/${sample.name}.ciri.out -F $config.genome -P -A $config.gtf -0
ciri.beforescript=if [ ! -d $dir.circRNA/$sample.name ]; then mkdir $dir.circRNA/$sample.name ; fi
ciri.afterscript=if [ ! -d $dir.report/3_CircRNA_Identification ];then mkdir $dir.report/3_CircRNA_Identification;fi <br/>\
cp $dir.circRNA/$sample.name/${sample.name}.ciri.out $dir.report/3_CircRNA_Identification/${sample.name}.ciri.out.xls <br/>\
head -n 5 $dir.report/3_CircRNA_Identification/${sample.name}.ciri.out.xls  > $dir.report/3_CircRNA_Identification/${sample.name}.ciri.out.xls.head5 <br/>\
head -n 1 $dir.circRNA/$sample.name/${sample.name}.ciri.out > $dir.circRNA/$sample.name/${sample.name}.ciri.filtered.out.xls <br/>\
awk '\$5>=2' $dir.circRNA/$sample.name/${sample.name}.ciri.out >> $dir.circRNA/$sample.name/${sample.name}.ciri.filtered.out.xls <br/>\
sed '1d' $dir.circRNA/$sample.name/${sample.name}.ciri.filtered.out.xls | awk '{print \$1}' | sort > $dir.circRNA/$sample.name/${sample.name}.ciri.filtered.id <br/>\
sed '1d' $dir.circRNA/$sample.name/${sample.name}.ciri.out > $dir.circRNA/$sample.name/${sample.name}.ciri.out.tmp <br/>\
awk '{print \$1"\t"\$5}' $dir.circRNA/$sample.name/${sample.name}.ciri.filtered.out.xls > $dir.srpbm/${sample.name}.junctionreads.txt <br/>\
sed '1d' $dir.circRNA/$sample.name/${sample.name}.ciri.filtered.out.xls | awk '{print \$1}' | sort | awk '{print \$1"\t"1}' | sed '1i circRNA_ID\t$sample.name' > $dir.circRNA/${sample.name}.ciri.filtered.tmp <br/>\
cp $dir.circRNA/$sample.name/${sample.name}.ciri.filtered.out.xls $dir.report/3_CircRNA_Identification <br/>\
cp $config.readme/circRNA.readme.txt $dir.report/3_CircRNA_Identification/readme.txt
ciri.checkbefore=$dir.bwa/$sample.name/${sample.name}_aln.sam
ciri.checkafter=$dir.circRNA/$sample.name/${sample.name}.ciri.out
ciri.prev=bwa

#filterstat
filter_ciri_stat=cat
filter_ciri_stat.run=1
filter_ciri_stat.param= $dir.circRNA/*/*.ciri.filtered.id | sort -u | sed '1i circRNA' > $dir.circRNA/all.circRNA.id
filter_ciri_stat.afterscript=perl $tools.bin2/generate_filter_ciri.pl $dir.circRNA $dir.circRNA/add.sh <br/>\
sh $dir.circRNA/add.sh <br/>\
sed 's/-/0/g' $dir.circRNA/all.circRNA.id > $dir.circRNA/all.circRNA.tmp <br/>\
perl $tools.bin2/circRNA_filter_count.pl $dir.circRNA/all.circRNA.tmp $dir.circRNA/all.circRNA.tmp2 <br/>\
awk '\$NF >= $config.common_sample_number' $dir.circRNA/all.circRNA.tmp2 | awk '{print \$1}' > $dir.circRNA/final.ciri.id
filter_ciri_stat.checkbefore=[% FOREACH sample IN combine.samples %] $dir.circRNA/$sample.name/${sample.name}.ciri.filtered.id | [% END %]
filter_ciri_stat.checkafter=$dir.circRNA/final.ciri.id
filter_ciri_stat.type=combine
filter_ciri_stat.prev=ciri

#junction reads
junctionreads=perl
junctionreads.run=1
junctionreads.param=$tools.bin/addDesc.pl -input $dir.circRNA/final.ciri.id -desc $dir.srpbm/${sample.name}.junctionreads.txt -output $dir.srpbm/${sample.name}.rawCount.tmp <br/>\
sed 's/-/0/g' $dir.srpbm/${sample.name}.rawCount.tmp | sed '1d' > $dir.srpbm/${sample.name}.rawCount.txt <br/>\
rm $dir.srpbm/${sample.name}.rawCount.tmp <br/>\
perl $tools.bin2/junctionreads2srpbm.pl $dir.srpbm/${sample.name}.rawCount.txt $dir.hisat/${sample.name}.align_summary.xls $sample.name $dir.srpbm/${sample.name}.srpbm.txt <br/>\
sed 's/^/$sample.name\t/' $dir.srpbm/${sample.name}.srpbm.txt | sed '1d' > $dir.srpbm/${sample.name}.srpbm.tmp
junctionreads.beforescript=
junctionreads.afterscript=
junctionreads.checkbefore=
junctionreads.checkafter=
junctionreads.prev=filter_ciri_stat

#srpbm stat
srpbmstat=cat
srpbmstat.run=1
srpbmstat.param=$dir.srpbm/*.srpbm.tmp > $dir.srpbm/all.srpbm.xls.tmp
srpbmstat.afterscript=if [ ! -d $dir.report/4_CircRNAExpression ];then mkdir $dir.report/4_CircRNAExpression;fi <br/>\
perl $tools.bin2/srpbmplot.pl $dir.srpbm/all.srpbm.xls.tmp $dir.srpbm <br/>\
#rm $dir.srpbm/*.tmp <br/>\
#rm $dir.srpbm/tmp <br/>\
perl $tools.bin2/mergesrpbm1.pl $dir.srpbm $dir.srpbm <br/>\
perl $tools.bin/expr/all.corStat.pl $dir.srpbm/all.sample.srpbm.cor.xls $dir.srpbm all.sample <br/>\
perl $tools.bin2/mergesrpbm2.pl $dir.srpbm $dir.srpbm <br/>\
cp $dir.srpbm/all.sample.srpbm.boxplot.p* $dir.report/4_CircRNAExpression <br/>\
cp $dir.srpbm/all.sample.srpbm.density.p* $dir.report/4_CircRNAExpression <br/>\
cp $dir.srpbm/all.sample.exp.srpbm.xls $dir.report/4_CircRNAExpression <br/>\
head -n 5 $dir.srpbm/all.sample.exp.srpbm.xls > $dir.report/4_CircRNAExpression/all.sample.exp.srpbm.xls.head5 <br/>\
cp $dir.srpbm/all.sample.cor.person.p* $dir.report/4_CircRNAExpression <br/>\
cp $config.readme/srpbm.readme.txt $dir.report/4_CircRNAExpression/readme.txt
srpbmstat.checkbefore=
srpbmstat.checkafter=
srpbmstat.type=combine
srpbmstat.prev=junctionreads

#get_circRNA_fa
extract_circRNA_fa=perl
extract_circRNA_fa.run=1
extract_circRNA_fa.param=$tools.bin2/ciriout2bed.pl $dir.circRNA/get_fa/final.ciri.id.exon.out $dir.circRNA/get_fa/final.ciri.id.exon.bed
extract_circRNA_fa.beforescript=if [ ! -d $dir.circRNA/get_fa ]; then mkdir $dir.circRNA/get_fa;fi <br/>\
cat $dir.circRNA/*/*.ciri.out.tmp |sed '1i circRNA_ID\tchr\tcircRNA_start\tcircRNA_end\t#junction_reads\tSM_MS_SMS\t#non_junction_reads\tjunction_reads_ratio\tcircRNA_type\tgene_id\tjunction_reads_ID' > $dir.circRNA/get_fa/all.ciri.out.all.tmp <br/>\
perl $tools.bin/addDesc.pl -input $dir.circRNA/final.ciri.id -desc $dir.circRNA/get_fa/all.ciri.out.all.tmp -output $dir.circRNA/get_fa/final.ciri.id.out <br/>\
grep 'exon' $dir.circRNA/get_fa/final.ciri.id.out > $dir.circRNA/get_fa/final.ciri.id.exon.out <br/>\
grep 'intergenic' $dir.circRNA/get_fa/final.ciri.id.out > $dir.circRNA/get_fa/final.ciri.id.intergenic.out <br/>\
grep 'intron' $dir.circRNA/get_fa/final.ciri.id.out > $dir.circRNA/get_fa/final.ciri.id.intron.out
extract_circRNA_fa.afterscript=$tools.bedtools/bedtools intersect -a $dir.circRNA/get_fa/final.ciri.id.exon.bed -b $config.exonbed -wb > $dir.circRNA/get_fa/final.ciri.id.exon.bedtools.out <br/>\
perl $tools.bin2/length.pl $dir.circRNA/get_fa/final.ciri.id.exon.bedtools.out $dir.circRNA/get_fa/final.ciri.id.exon.bedtools.out_step1 <br/> \
awk -F "\t" '{print \$10"\t"\$1}' $dir.circRNA/get_fa/final.ciri.id.exon.out | sed '1i geneid\tcircRNA' > $dir.circRNA/get_fa/final.ciri.id.exon.gene.id <br/> \
perl $tools.bin/addDesc.pl -input $dir.circRNA/get_fa/final.ciri.id.exon.gene.id -desc $config.genejointr -output $dir.circRNA/get_fa/final.ciri.id.exon.gene.id.tmp <br/>\
perl $tools.bin2/joined_tran_circRNA.pl $dir.circRNA/get_fa/final.ciri.id.exon.gene.id.tmp $dir.circRNA/get_fa/final.ciri.tran.join.id <br/>\
perl $tools.bin2/get_the_matched_tran_circRNA.pl $dir.circRNA/get_fa/final.ciri.tran.join.id $dir.circRNA/get_fa/final.ciri.id.exon.bedtools.out_step1 $dir.circRNA/get_fa/final.ciri.id.exon.bedtools.out_step2 <br/>\
perl $tools.bin2/dereplication_tran.pl $dir.circRNA/get_fa/final.ciri.id.exon.bedtools.out_step2 $dir.circRNA/get_fa/final.ciri.id.exon.bedtools.out_step3 <br/>\
perl $tools.bin2/length2fa_new.pl $config.genome $dir.circRNA/get_fa/final.ciri.id.exon.bedtools.out_step3 $dir.circRNA/get_fa/final.ciri.id.exon.fa <br/>\
grep 'exon' $dir.circRNA/get_fa/final.ciri.id.exon.fa | awk -F ":" '{print \$1":"\$2}' | sort -u| sed 's/>//g' > $dir.circRNA/get_fa/1 <br/>\
grep '>' $dir.circRNA/get_fa/final.ciri.id.exon.fa | awk -F ":" '{print \$1":"\$2}' | sort -u | sed 's/>//g' > $dir.circRNA/get_fa/2 <br/>\
comm -13 $dir.circRNA/get_fa/1 $dir.circRNA/get_fa/2 > $dir.circRNA/get_fa/notfullexon.id <br/>\
perl $tools.bin2/extract-partexonid-circRNAfa.pl $dir.circRNA/get_fa/notfullexon.id $dir.circRNA/get_fa/final.ciri.id.exon.fa $dir.circRNA/get_fa/final.ciri.id.exon.fa_part1 <br/>\
grep 'exon' $dir.circRNA/get_fa/final.ciri.id.exon.fa | sed 's/>//g' > $dir.circRNA/get_fa/final.ciri.id.exon.fa_part2.id <br/>\
perl $tools.bin2/extract-exonid-circRNAfa.pl $dir.circRNA/get_fa/final.ciri.id.exon.fa_part2.id $dir.circRNA/get_fa/final.ciri.id.exon.fa $dir.circRNA/get_fa/final.ciri.id.exon.fa_part2 <br/>\
cat $dir.circRNA/get_fa/final.ciri.id.exon.fa_part2 $dir.circRNA/get_fa/final.ciri.id.exon.fa_part1 > $dir.circRNA/get_fa/final.final.ciri.id.exon.fa <br/>\
perl $tools.bin2/get_intergenic_fa.pl $config.genome $dir.circRNA/get_fa/final.ciri.id.intergenic.out $dir.circRNA/get_fa/final.ciri.id.intergenic.fa <br/>\
perl $tools.bin2/get_intron_step1.pl $dir.circRNA/get_fa/final.ciri.id.intron.out $dir.circRNA/get_fa/final.ciri.id.intron.out_step1 <br/>\
perl $tools.bin/addDesc.pl -input $dir.circRNA/get_fa/final.ciri.id.intron.out_step1 -desc $config.gene_strand -output $dir.circRNA/get_fa/final.ciri.id.intron.out_step2 <br/>\
perl $tools.bin2/get_intron_fa.pl $config.genome $dir.circRNA/get_fa/final.ciri.id.intron.out_step2 $dir.circRNA/get_fa/final.ciri.id.intron.fa <br/>\
cat $dir.circRNA/get_fa/final.final.ciri.id.exon.fa $dir.circRNA/get_fa/final.ciri.id.intergenic.fa $dir.circRNA/get_fa/final.ciri.id.intron.fa > $dir.circRNA/get_fa/final.circRNA.fa <br/>\
perl $tools.bin2/quchongfusequence.pl $dir.circRNA/get_fa/final.circRNA.fa $dir.circRNA/get_fa/final.circRNA.reduant.fa <br/>\
perl $tools.bin2/reverse.pl $dir.circRNA/get_fa/final.circRNA.reduant.fa $dir.circRNA/get_fa/final.circRNA.reduant.reverse.fa <br/>\
cp $dir.circRNA/get_fa/final.circRNA.reduant.reverse.fa $dir.report/3_CircRNA_Identification/final.circRNA.fa
extract_circRNA_fa.checkbefore=
extract_circRNA_fa.checkafter= $dir.circRNA/get_fa/final.circRNA.reduant.reverse.fa
extract_circRNA_fa.type=combine
extract_circRNA_fa.prev=srpbmstat

#get_circRNA_desc
get_circRNA_desc=perl
get_circRNA_desc.run=1
get_circRNA_desc.param=$tools.bin/addDesc.pl -input $dir.circRNA/all.circRNA.desc.tmp2 -desc $config.desc -output $dir.circRNA/all.circRNA.desc.tmp3
get_circRNA_desc.beforescript=awk -F "\t" '{print \$1"\t"\$2"\t"\$3"\t"\$4"\t"\$9"\t"\$10}' $dir.circRNA/get_fa/final.ciri.id.out | sed '1d' |awk '{print \$1"\t"\$2"\t"\$3"\t"\$4"\t"\$5"\t"\$6}' | sed 's/region/intergenic/g' | sed '1i circRNA_ID\tchr\tcircRNA_start\tcircRNA_end\tregion\thost_gene_id' > $dir.circRNA/all.circRNA.desc.tmp <br/>\
awk '{print \$6"\t"\$1"\t"\$2"\t"\$3"\t"\$4"\t"\$5}' $dir.circRNA/all.circRNA.desc.tmp > $dir.circRNA/all.circRNA.desc.tmp2
get_circRNA_desc.afterscript=awk -F "\t" '{print \$2"\t"\$1"\t"\$6"\t"\$10}' $dir.circRNA/all.circRNA.desc.tmp3 > $dir.circRNA/all.circRNA.desc.regionstat.txt <br/>\
awk -F "\t" '{print \$2"\t"\$3"\t"\$4"\t"\$5"\t"\$1"\t"\$7"\t"\$8"\t"\$9"\t"\$10"\t"\$11}' $dir.circRNA/all.circRNA.desc.tmp3 > $dir.circRNA/all.circRNA.desc.tmp4 <br/>\
sed '1d' $dir.circRNA/all.circRNA.desc.tmp4 | sed '1i circRNA_ID\tchr\tcircRNA_start\tcircRNA_end\thost_gene_id\thost_Symbol\thost_gene_name\thost_Chromosome\thost_Gene_biotype\thost_Description' > $dir.circRNA/all.circRNA.desc.xls <br/>\
perl $tools.bin2/stat.hostgene.pl $dir.circRNA/all.circRNA.desc.xls $dir.circRNA <br/>\
cp $dir.circRNA/circRNA.hostgene.number.stat.txt $dir.report/3_CircRNA_Identification <br/>\
cp $dir.circRNA/circRNA.hostgene.number.stat.p* $dir.report/3_CircRNA_Identification <br/>\
cp $dir.circRNA/all.circRNA.desc.xls $dir.report/3_CircRNA_Identification/final.circRNA.xls <br/>\
head -n 5 $dir.report/3_CircRNA_Identification/final.circRNA.xls > $dir.report/3_CircRNA_Identification/final.circRNA.xls.head5
get_circRNA_desc.checkbefore=
get_circRNA_desc.checkafter=
get_circRNA_desc.type=combine
get_circRNA_desc.prev=extract_circRNA_fa

#miRNA target
targetscan=$tools.targetscan
targetscan.run=1
targetscan.script=perl
targetscan.param=$config.seed $dir.circRNA_miRNA/final.circRNA.targetscan.txt $dir.circRNA_miRNA/final.circRNA.targetscan.out
targetscan.beforescript=if [ ! -d $dir.report/6_CircRNA_miRNA_interaction ]; then mkdir $dir.report/6_CircRNA_miRNA_interaction;fi <br/>\
perl $tools.bin2/tranfa2targentype.pl $dir.circRNA/get_fa/final.circRNA.reduant.reverse.fa $config.taxid $dir.circRNA_miRNA/final.circRNA.targetscan.txt
targetscan.afterscript=perl $tools.bin2/count_targetscan_all.pl $dir.circRNA_miRNA/final.circRNA.targetscan.out $dir.circRNA_miRNA/final.circRNA.targetscan.stat.txt <br/>\
awk '{print \$1";"\$2"\t"\$3}' $dir.circRNA_miRNA/final.circRNA.targetscan.stat.txt > $dir.circRNA_miRNA/final.circRNA.targetscan.stat.tmp <br/>\
cp $dir.circRNA_miRNA/final.circRNA.targetscan.out $dir.report/6_CircRNA_miRNA_interaction/all.circRNA.targetscan.out.xls <br/>\
head -n 5 $dir.report/6_CircRNA_miRNA_interaction/all.circRNA.targetscan.out.xls > $dir.report/6_CircRNA_miRNA_interaction/all.circRNA.targetscan.out.xls.head5
targetscan.checkafter=$dir.circRNA_miRNA/final.circRNA.targetscan.out
targetscan.type=combine
targetscan.prev=extract_circRNA_fa

miranda=$tools.miranda
miranda.run=1
miranda.param=$config.mature_miRNA $dir.circRNA/get_fa/final.circRNA.reduant.reverse.fa > $dir.circRNA_miRNA/final.circRNA.miranda.txt
miranda.beforescript=if [ ! -d $dir.report/6_CircRNA_miRNA_interaction ]; then mkdir $dir.report/6_CircRNA_miRNA_interaction;fi
miranda.afterscript=grep '>' $dir.circRNA_miRNA/final.circRNA.miranda.txt | grep -v '>>' | sed 's/>//g' > $dir.circRNA_miRNA/final.circRNA.miranda.txt.tmp <br/>\
perl $tools.bin2/count_miranda_all.pl $dir.circRNA_miRNA/final.circRNA.miranda.txt.tmp $dir.circRNA_miRNA/final.circRNA.miranda.stat.txt <br/>\
awk '{print \$1";"\$2"\t"\$3}' $dir.circRNA_miRNA/final.circRNA.miranda.stat.txt > $dir.circRNA_miRNA/final.circRNA.miranda.stat.tmp <br/>\
perl /DG/programs/stable/workflow/current/sRNA/sRNA_bin/target/get_miRanda.pl $dir.circRNA_miRNA/final.circRNA.miranda.txt $dir.circRNA_miRNA/final.circRNA.miranda.out.txt $dir.circRNA_miRNA/final.circRNA.miranda.list.txt <br/>\
cp $dir.circRNA_miRNA/final.circRNA.miranda.out.txt $dir.report/6_CircRNA_miRNA_interaction/all.circRNA.miranda.out.txt
miranda.checkafter=
miranda.type=combine
miranda.prev=extract_circRNA_fa

#miRNA stat
miRNA_stat=perl
miRNA_stat.run=1
miRNA_stat.param=$tools.bin/addDesc.pl -input $dir.circRNA_miRNA/final.circRNA.miranda.stat.tmp -desc $dir.circRNA_miRNA/final.circRNA.targetscan.stat.tmp -output $dir.circRNA_miRNA/circRNA_miRNA_prediction.stat.tmp
miRNA_stat.beforescript=
miRNA_stat.afterscript=awk '\$3!~/-/' $dir.circRNA_miRNA/circRNA_miRNA_prediction.stat.tmp | sed 's/;/\t/' > $dir.circRNA_miRNA/circRNA_miRNA_prediction.stat.xls <br/>\
cp $dir.circRNA_miRNA/circRNA_miRNA_prediction.stat.xls $dir.report/6_CircRNA_miRNA_interaction <br/>\
head -n 5 $dir.circRNA_miRNA/circRNA_miRNA_prediction.stat.xls > $dir.report/6_CircRNA_miRNA_interaction/circRNA_miRNA_prediction.stat.xls.head5 <br/>\
cp $config.readme/circRNA_miRNA.readme.txt $dir.report/6_CircRNA_miRNA_interaction/readme.txt
miRNA_stat.type=combine
miRNA_stat.prev=miranda

circRNA_edgeR.run=$config.edgeRrun
circRNA_edgeR=$tools.edgeR/run_DE_analysis_pvalue.pl
circRNA_edgeR.script=perl
circRNA_edgeR.param=--matrix $dir.circRNA_diff/${group.name}.rawCount.xls --method edgeR --output $dir.circRNA_diff \
[% name2=group.control %][% IF name2.match(",") %] --samples_file $dir.circRNA_diff/${group.name}.samp.list \
[% ELSE %] --dispersion 0.05 [% END %]
circRNA_edgeR.beforescript=if [ ! -d "$dir.report/5_CircRNA_DifferentialExpression" ];then mkdir $dir.report/5_CircRNA_DifferentialExpression; fi <br/>\
perl $tools.bin/mergeHtseq.pl $dir.srpbm $group.control $group.case $group.control_group $group.case_group $group.name $dir.circRNA_diff
circRNA_edgeR.afterscript=perl $tools.bin2/extract_sigDiffGene.pl $dir.circRNA_diff/${group.name}.rawCount.xls.${group.control_group}_vs_${group.case_group}.edgeR.DE_results $dir.circRNA_diff/${group.name}.diff.xls $dir.circRNA_diff/${group.name}.sigDiff.xls $dir.circRNA_diff/${group.name}.sigDiff.glist <br/>\
awk '{print \$1}' $dir.circRNA_diff/${group.name}.sigDiff.glist > $dir.circRNA_diff/${group.name}.sigDiff.srpbm.xls <br/>\
perl $tools.bin2/merge_rpkm.pl $dir.srpbm $group.control,$group.case $dir.circRNA_diff $group.name <br/>\
perl $tools.bin/addDesc.pl -input $dir.circRNA_diff/${group.name}.diff.xls -desc $dir.circRNA_diff/${group.name}.srpbm.xls -output $dir.circRNA_diff/${group.name}.diff.srpbm.xls <br/>\
perl $tools.bin/changeorder.pl $dir.circRNA_diff/${group.name}.diff.srpbm.xls $dir.circRNA_diff/${group.name}.diff.srpbm.tmp <br/>\
mv $dir.circRNA_diff/${group.name}.diff.srpbm.tmp $dir.circRNA_diff/${group.name}.diff.srpbm.xls <br/>\
perl $tools.bin2/srpbm2scattorPlot.pl $dir.circRNA_diff/${group.name}.diff.srpbm.xls $group.control $group.case $group.control_group $group.case_group $dir.circRNA_diff <br/>\
perl $tools.bin/addDesc.pl -input $dir.circRNA_diff/${group.name}.sigDiff.srpbm.xls -desc $dir.circRNA_diff/${group.name}.srpbm.xls -output $dir.circRNA_diff/${group.name}.sigDiff.srpbm.xls <br/>\
perl $tools.bin/diff/heatmap.pl $dir.circRNA_diff/${group.name}.sigDiff.srpbm.xls $group.name $dir.circRNA_diff <br/>\
perl $tools.bin/addDesc.pl -input $dir.circRNA_diff/${group.name}.diff.srpbm.xls -desc $dir.circRNA/all.circRNA.desc.xls -output $dir.circRNA_diff/${group.name}.diff.srpbm.desc.xls <br/>\
head -n 5 $dir.circRNA_diff/${group.name}.diff.srpbm.desc.xls > $dir.report/5_CircRNA_DifferentialExpression/${group.name}.diff.srpbm.desc.xls.head5 <br/>\
perl $tools.bin/addDesc.pl -input $dir.circRNA_diff/${group.name}.sigDiff.srpbm.xls -desc $dir.circRNA/all.circRNA.desc.xls -output $dir.circRNA_diff/${group.name}.sigDiff.srpbm.desc.xls <br/>\
cp $dir.circRNA_diff/${group.name}.rawCount.xls.${group.control_group}_vs_${group.case_group}.edgeR.DE_results.MA_n_Volcano.pdf $dir.report/5_CircRNA_DifferentialExpression/${group.name}.edgeR.MA_n_Volcano.pdf <br/>\
convert $dir.circRNA_diff/${group.name}.rawCount.xls.${group.control_group}_vs_${group.case_group}.edgeR.DE_results.MA_n_Volcano.pdf $dir.circRNA_diff/${group.name}.edgeR.MA_n_Volcano.png <br/>\
cp $dir.circRNA_diff/${group.name}.sigDiff.srpbm.desc.xls $dir.report/5_CircRNA_DifferentialExpression <br/>\
cp $dir.circRNA_diff/${group.name}.diff.srpbm.desc.xls $dir.report/5_CircRNA_DifferentialExpression <br/>\
cp $dir.circRNA_diff/${group.name}.heatmap.p* $dir.report/5_CircRNA_DifferentialExpression <br/>\
cp $dir.circRNA_diff/${group.name}.edgeR.MA_n_Volcano.png $dir.report/5_CircRNA_DifferentialExpression <br/>\
cp $config.readme/circRNA_diff.readme.txt $dir.report/5_CircRNA_DifferentialExpression/readme.txt
circRNA_edgeR.checkafter=$dir.circRNA_diff/${group.name}.sigDiff.srpbm.desc.xls
circRNA_edgeR.type=group
circRNA_edgeR.prev=srpbmstat

#GO annot
circRNA_hostgene_GO.run=1
circRNA_hostgene_GO=$tools.GO/functional.pl
circRNA_hostgene_GO.script=perl
circRNA_hostgene_GO.param=-go -glist $dir.circRNA_diff/GO/${group.name}.sigDiff.circRNA.hostgene.glist -sdir $config.GO -species $config.species -outdir $dir.circRNA_diff/GO
circRNA_hostgene_GO.beforescript=if [ ! -d $dir.circRNA_diff/GO ]; then mkdir $dir.circRNA_diff/GO;fi <br/>\
if [ ! -d $dir.report/5_CircRNA_DifferentialExpression/GO ]; then mkdir $dir.report/5_CircRNA_DifferentialExpression/GO;fi <br/>\
perl $tools.bin/addDesc.pl -input $dir.circRNA_diff/${group.name}.sigDiff.glist -desc $dir.circRNA/all.circRNA.desc.xls -output $dir.circRNA_diff/${group.name}.sigDiff.tmp <br/>\
awk -F "\t" '{print \$6}' $dir.circRNA_diff/${group.name}.sigDiff.tmp | grep -v 'intergenic' | sed '1d' |sort -u |sed '1i hostgene_id\thostgene_id' | awk '{print \$1"\t"\$1}' > $dir.circRNA_diff/GO/${group.name}.sigDiff.circRNA.hostgene.glist <br/>\
awk '{print \$1"\t"\$1"\t"\$1"\t"\$1"\t"\$1}' $dir.circRNA_diff/GO/${group.name}.sigDiff.circRNA.hostgene.glist > $dir.circRNA_diff/GO/${group.name}.sigDiff.circRNA.hostgene.sigDiff.xls
circRNA_hostgene_GO.afterscript=perl $tools.GO/drawGO.pl -indir $dir.circRNA_diff/GO -diff ${group.name}.sigDiff.circRNA.hostgene -outdir $dir.circRNA_diff/GO -go $config.GO/$config.species -goclass /DG/home/yut/GO/go.class <br/>\
cp $config.readme/go.readme.txt $dir.report/5_CircRNA_DifferentialExpression/GO/readme.txt <br/>\
cp $dir.circRNA_diff/GO/${group.name}.sigDiff.circRNA.hostgene.goclass.*g $dir.report/5_CircRNA_DifferentialExpression/GO <br/>\
perl $tools.bin/diff/id2symbol.pl $dir.circRNA_diff/GO/GO/${group.name}.sigDiff.circRNA.hostgene_C.txt 6 $config.desc $dir.report/5_CircRNA_DifferentialExpression/GO/${group.name}.sigDiff.circRNA.hostgene_C.xls <br/>\
perl $tools.bin/diff/id2symbol.pl $dir.circRNA_diff/GO/GO/${group.name}.sigDiff.circRNA.hostgene_F.txt 6 $config.desc $dir.report/5_CircRNA_DifferentialExpression/GO/${group.name}.sigDiff.circRNA.hostgene_F.xls <br/>\
perl $tools.bin/diff/id2symbol.pl $dir.circRNA_diff/GO/GO/${group.name}.sigDiff.circRNA.hostgene_P.txt 6 $config.desc $dir.report/5_CircRNA_DifferentialExpression/GO/${group.name}.sigDiff.circRNA.hostgene_P.xls
circRNA_hostgene_GO.type=group
circRNA_hostgene_GO.prev=circRNA_edgeR

circRNA_hostgene_kegg=$tools.kobas/annotate.py
circRNA_hostgene_kegg.script=python
circRNA_hostgene_kegg.run=1
circRNA_hostgene_kegg.param=-i $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.glist $parameter.kobas_annot -o $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.annot -n 4
circRNA_hostgene_kegg.beforescript=if [ ! -d $dir.circRNA_diff/KEGG ]; then mkdir $dir.circRNA_diff/KEGG;fi <br/>\
if [ ! -d $dir.report/5_CircRNA_DifferentialExpression/KEGG ];then mkdir $dir.report/5_CircRNA_DifferentialExpression/KEGG;fi <br/>\
perl $tools.bin/addDesc.pl -input $dir.circRNA_diff/${group.name}.sigDiff.glist -desc $dir.circRNA/all.circRNA.desc.xls -output $dir.circRNA_diff/${group.name}.sigDiff.tmp <br/>\
awk -F "\t" '{print \$6}' $dir.circRNA_diff/${group.name}.sigDiff.tmp | grep -v 'intergenic' | sed '1d' |sort -u |sed '1i hostgene_id\thostgene_id' | awk '{print \$1}' > $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.glist
circRNA_hostgene_kegg.afterscript=python $tools.kobas/identify.py -f $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.annot $parameter.kobas_identify -o $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.txt <br/>\
perl $tools.bin/diff/kobas.id2symbol.pl $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.txt 7 $config.desc $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.xls <br/>\
perl $tools.bin/diff/kobas.path_picture.pl -i $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.txt -n ${group.name}.hostgene -o $dir.circRNA_diff/KEGG <br/>\
cp $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kobas.xls $dir.report/5_CircRNA_DifferentialExpression/KEGG <br/>\
cp $dir.circRNA_diff/KEGG/${group.name}.hostgene.kegg.png $dir.report/5_CircRNA_DifferentialExpression/KEGG/${group.name}.sigDiff.circRNA.hostgene.kegg.png <br/>\
cp $dir.circRNA_diff/KEGG/${group.name}.hostgene.kegg.pdf $dir.report/5_CircRNA_DifferentialExpression/KEGG/${group.name}.sigDiff.circRNA.hostgene.kegg.pdf <br/>\
cp $config.readme/kegg.readme.txt $dir.report/5_CircRNA_DifferentialExpression/KEGG/readme.txt
circRNA_hostgene_kegg.checkafter=$dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kegg.png | $dir.circRNA_diff/KEGG/${group.name}.sigDiff.circRNA.hostgene.kegg.pdf
circRNA_hostgene_kegg.type=group
circRNA_hostgene_kegg.prev=circRNA_edgeR
